<!DOCTYPE html>
<html class="writer-html5" lang="en" >

<!-- Mirrored from eecs390.github.io/notes/foundations.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 19 Mar 2024 18:15:35 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Introduction &mdash; Programming Language Principles and Paradigms 0.4 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="_static/style-extra.css" type="text/css" />
      <link rel="stylesheet" href="_static/dark_mode_css/general.css" type="text/css" />
      <link rel="stylesheet" href="_static/dark_mode_css/dark.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/jquery3b25.js?v=5d32c60e"></script>
        <script src="_static/_sphinx_javascript_frameworks_compatfa9a.js?v=2cd50e6c"></script>
        <script src="_static/documentation_options804b.js?v=7f00635f"></script>
        <script src="_static/doctools56c1.js?v=888ff710"></script>
        <script src="_static/sphinx_highlight7f57.js?v=dc90522c"></script>
        <script src="_static/js-extraf31b.js?v=c32e72a1"></script>
        <script async="async" src="../../cdn.jsdelivr.net/npm/mathjax%403/es5/tex-mml-chtml.js"></script>
        <script src="_static/dark_mode_js/default_light679c.js?v=c2e647ce"></script>
        <script src="_static/dark_mode_js/theme_switcher2b7c.js?v=358d3910"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Introduction to Scheme" href="functional.html" />
    <link rel="prev" title="Programming Language Principles and Paradigms" href="index-2.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #C53390" >

          
          
          <a href="index-2.html" class="icon icon-home">
            Programming Language Principles and Paradigms
          </a>
              <div class="version">
                0.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="https://eecs390.github.io/notes/search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Foundations</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="#basic-python">Basic Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#variables">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#basic-data-structures">Basic Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compound-statements">Compound Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#function-definitions">Function Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#class-definitions">Class Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#modules">Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#executing-a-module">Executing a Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#python-reference-semantics">Python Reference Semantics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#basic-elements">Basic Elements</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#levels-of-description">Levels of Description</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#lexical-structure">Lexical Structure</a></li>
<li class="toctree-l3"><a class="reference internal" href="#syntax">Syntax</a></li>
<li class="toctree-l3"><a class="reference internal" href="#semantics">Semantics</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#entities-objects-and-variables">Entities, Objects, and Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#l-values-and-r-values">L-Values and R-Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="#expressions">Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#statements">Statements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#names-and-environments">Names and Environments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#blocks">Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#name-lookup">Name Lookup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nested-inline-blocks">Nested Inline Blocks</a></li>
<li class="toctree-l2"><a class="reference internal" href="#scope-in-functions">Scope in Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id2">Static Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="#dynamic-scope">Dynamic Scope</a></li>
<li class="toctree-l2"><a class="reference internal" href="#point-of-declaration-or-definition">Point of Declaration or Definition</a></li>
<li class="toctree-l2"><a class="reference internal" href="#implementation-strategies">Implementation Strategies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#control-flow">Control Flow</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#expression-sequencing">Expression Sequencing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#short-circuiting">Short Circuiting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#explicit-sequences">Explicit Sequences</a></li>
<li class="toctree-l3"><a class="reference internal" href="#compound-assignment">Compound Assignment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#statement-sequences">Statement Sequences</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unstructured-transfer-of-control">Unstructured Transfer of Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="#structured-control">Structured Control</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#conditionals">Conditionals</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loops">Loops</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loop-termination">Loop Termination</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exceptions">Exceptions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#memory-management">Memory Management</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#storage-duration-classes">Storage Duration Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#static-storage">Static Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#automatic-storage">Automatic Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#thread-local-storage">Thread-Local Storage</a></li>
<li class="toctree-l3"><a class="reference internal" href="#dynamic-storage">Dynamic Storage</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#value-and-reference-semantics">Value and Reference Semantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#raii-and-scope-based-resource-management">RAII and Scope-Based Resource Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="#garbage-collection">Garbage Collection</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#reference-counting">Reference Counting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tracing-collectors">Tracing Collectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="#finalizers">Finalizers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#grammars">Grammars</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#regular-expressions">Regular Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#context-free-grammars">Context-Free Grammars</a></li>
<li class="toctree-l2"><a class="reference internal" href="#grammars-in-programming-languages">Grammars in Programming Languages</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#vexing-parse">Vexing Parse</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Functional Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="functional.html">Introduction to Scheme</a><ul>
<li class="toctree-l2"><a class="reference internal" href="functional.html#expressions">Expressions</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#definitions">Definitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#compound-values">Compound Values</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#symbolic-data">Symbolic Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="functional.html#functions">Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="functional.html#keyword-arguments">Keyword Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#default-arguments">Default Arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#variadic-functions">Variadic Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#parameter-passing">Parameter Passing</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#evaluation-of-function-calls">Evaluation of Function Calls</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="functional.html#recursion">Recursion</a><ul>
<li class="toctree-l2"><a class="reference internal" href="functional.html#activation-records">Activation Records</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#tail-recursion">Tail Recursion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="functional.html#higher-order-functions">Higher-Order Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="functional.html#function-objects">Function Objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#functions-as-parameters">Functions as Parameters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="functional.html#function-pointers">Function Pointers</a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#binding-policy">Binding Policy</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#nested-functions">Nested Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="functional.html#decorators">Decorators</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="functional.html#lambda-functions">Lambda Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="functional.html#scheme">Scheme</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#python">Python</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#java">Java</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#c">C++</a></li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#common-patterns">Common Patterns</a><ul>
<li class="toctree-l3"><a class="reference internal" href="functional.html#sequence-patterns">Sequence Patterns</a><ul>
<li class="toctree-l4"><a class="reference internal" href="functional.html#map">Map</a></li>
<li class="toctree-l4"><a class="reference internal" href="functional.html#reduce">Reduce</a></li>
<li class="toctree-l4"><a class="reference internal" href="functional.html#filter">Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="functional.html#any">Any</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#composition">Composition</a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#partial-application-and-currying">Partial Application and Currying</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="functional.html#continuations">Continuations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="functional.html#restricted-continuations">Restricted Continuations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="functional.html#subroutines">Subroutines</a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#exceptions">Exceptions</a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#generators">Generators</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="functional.html#first-class-continuations">First-Class Continuations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="functional.html#signaling-errors">Signaling Errors</a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#call-and-return">Call and Return</a></li>
<li class="toctree-l3"><a class="reference internal" href="functional.html#id11">Exceptions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="theory.html">Lambda Calculus</a><ul>
<li class="toctree-l2"><a class="reference internal" href="theory.html#non-terminating-computation">Non-Terminating Computation</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#normal-order-evaluation">Normal-Order Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#encoding-data">Encoding Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="theory.html#booleans">Booleans</a></li>
<li class="toctree-l3"><a class="reference internal" href="theory.html#pairs">Pairs</a></li>
<li class="toctree-l3"><a class="reference internal" href="theory.html#church-numerals">Church Numerals</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#recursion">Recursion</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#equivalent-models">Equivalent Models</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="theory.html#operational-semantics">Operational Semantics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="theory.html#language">Language</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#states-and-transitions">States and Transitions</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#expressions">Expressions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="theory.html#arithmetic-expressions">Arithmetic Expressions</a></li>
<li class="toctree-l3"><a class="reference internal" href="theory.html#order-of-evaluation">Order of Evaluation</a></li>
<li class="toctree-l3"><a class="reference internal" href="theory.html#boolean-expressions">Boolean Expressions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#statements">Statements</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#examples">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#operational-semantics-for-lambda-calculus">Operational Semantics for Lambda Calculus</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="theory.html#formal-type-systems">Formal Type Systems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="theory.html#variables">Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#functions">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#subtyping">Subtyping</a><ul>
<li class="toctree-l3"><a class="reference internal" href="theory.html#subtyping-and-arithmetic-operators">Subtyping and Arithmetic Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="theory.html#the-top-type">The Top Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="theory.html#subtyping-and-functions">Subtyping and Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="theory.html#full-typing-rules">Full Typing Rules</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Data Abstraction</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data.html">Functional Data Abstraction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.html#pairs-and-lists">Pairs and Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#message-passing">Message Passing</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#lists">Lists</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#dictionaries">Dictionaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#dispatch-dictionaries">Dispatch Dictionaries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html#object-oriented-programming">Object-Oriented Programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.html#members">Members</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#access-control">Access Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#kinds-of-methods">Kinds of Methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#nested-and-local-classes">Nested and Local Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#implementation-strategies">Implementation Strategies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html#inheritance-and-polymorphism">Inheritance and Polymorphism</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.html#types-of-inheritance">Types of Inheritance</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#class-hierarchies">Class Hierarchies</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#method-overriding">Method Overriding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data.html#covariance-and-contravariance">Covariance and Contravariance</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#accessing-hidden-or-overridden-members">Accessing Hidden or Overridden Members</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data.html#implementing-dynamic-binding">Implementing Dynamic Binding</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data.html#full-lookup-and-dispatch-process">Full Lookup and Dispatch Process</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data.html#multiple-inheritance">Multiple Inheritance</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data.html#dictionary-based-implementation">Dictionary-Based Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#record-based-implementation">Record-Based Implementation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html#static-analysis">Static Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.html#types">Types</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data.html#type-equivalence">Type Equivalence</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#type-compatibility">Type Compatibility</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#type-inference">Type Inference</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data.html#control-flow-analysis">Control-Flow Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html#dynamic-typing">Dynamic Typing</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html#generics">Generics</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.html#implicit-parametric-polymorphism">Implicit Parametric Polymorphism</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#explicit-parametric-polymorphism">Explicit Parametric Polymorphism</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data.html#non-type-parameters">Non-Type Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#constraints">Constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#implementation">Implementation</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#java-generics">Java Generics</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#curiously-recurring-template-pattern">Curiously Recurring Template Pattern</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data.html#duck-typing">Duck Typing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data.html#modules-and-namespaces">Modules and Namespaces</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data.html#translation-units">Translation Units</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#modules-packages-and-namespaces">Modules, Packages, and Namespaces</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#linkage">Linkage</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#information-hiding">Information Hiding</a></li>
<li class="toctree-l2"><a class="reference internal" href="data.html#initialization">Initialization</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Declarative Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="declarative.html">Logic Programming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="declarative.html#prolog">Prolog</a><ul>
<li class="toctree-l3"><a class="reference internal" href="declarative.html#lists">Lists</a></li>
<li class="toctree-l3"><a class="reference internal" href="declarative.html#arithmetic">Arithmetic</a></li>
<li class="toctree-l3"><a class="reference internal" href="declarative.html#side-effects">Side Effects</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="declarative.html#unification-and-search">Unification and Search</a><ul>
<li class="toctree-l3"><a class="reference internal" href="declarative.html#search-order-and-backtracking">Search Order and Backtracking</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="declarative.html#the-cut-operator">The Cut Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="declarative.html#negation">Negation</a></li>
<li class="toctree-l2"><a class="reference internal" href="declarative.html#examples">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="declarative.html#constraints-and-dependencies">Constraints and Dependencies</a><ul>
<li class="toctree-l2"><a class="reference internal" href="declarative.html#constraint-logic-programming">Constraint Logic Programming</a><ul>
<li class="toctree-l3"><a class="reference internal" href="declarative.html#search">Search</a></li>
<li class="toctree-l3"><a class="reference internal" href="declarative.html#id2">Examples</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="declarative.html#make">Make</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="declarative.html#pattern-matching">Pattern Matching</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Metaprogramming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="metaprogramming.html">Macros and Code Generation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#scheme-macros">Scheme Macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#cpp-macros">CPP Macros</a><ul>
<li class="toctree-l3"><a class="reference internal" href="metaprogramming.html#stringification-and-concatenation">Stringification and Concatenation</a></li>
<li class="toctree-l3"><a class="reference internal" href="metaprogramming.html#the-macro-namespace">The Macro Namespace</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#code-generation">Code Generation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="metaprogramming.html#template-metaprogramming">Template Metaprogramming</a><ul>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#pairs">Pairs</a></li>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#numerical-computations">Numerical Computations</a></li>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#templates-and-function-overloading">Templates and Function Overloading</a></li>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#sfinae">SFINAE</a></li>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#ensuring-a-substitution-failure">Ensuring a Substitution Failure</a></li>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#variadic-templates">Variadic Templates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="metaprogramming.html#example-multidimensional-arrays">Example: Multidimensional Arrays</a><ul>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#points">Points</a></li>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#domains">Domains</a></li>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#arrays">Arrays</a></li>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#stencil">Stencil</a></li>
<li class="toctree-l2"><a class="reference internal" href="metaprogramming.html#nested-iteration">Nested Iteration</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Concurrent Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="concurrent.html">Parallel Computing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#parallelism-in-python">Parallelism in Python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="concurrent.html#threading">Threading</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrent.html#multiprocessing">Multiprocessing</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#the-problem-with-shared-state">The Problem with Shared State</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#when-no-synchronization-is-necessary">When No Synchronization is Necessary</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#synchronized-data-structures">Synchronized Data Structures</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#locks">Locks</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#barriers">Barriers</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#message-passing">Message Passing</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#application-examples">Application Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="concurrent.html#web-crawler">Web Crawler</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrent.html#particle-simulator">Particle Simulator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#synchronization-pitfalls">Synchronization Pitfalls</a><ul>
<li class="toctree-l3"><a class="reference internal" href="concurrent.html#under-synchronization">Under-synchronization</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrent.html#over-synchronization">Over-synchronization</a></li>
<li class="toctree-l3"><a class="reference internal" href="concurrent.html#deadlock">Deadlock</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#conclusion">Conclusion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="concurrent.html#asynchronous-tasks">Asynchronous Tasks</a><ul>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#limiting-the-number-of-tasks">Limiting the Number of Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="concurrent.html#launch-policy">Launch Policy</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #C53390" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index-2.html">Programming Language Principles and Paradigms</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index-2.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Introduction</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul><div class="rst-breadcrumbs-buttons" role="navigation" aria-label="Sequential page navigation">
        <a href="index-2.html" class="btn btn-neutral float-left" title="Programming Language Principles and Paradigms" accesskey="p"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="functional.html" class="btn btn-neutral float-right" title="Introduction to Scheme" accesskey="n">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
  </div>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Foundations</h1><p>This text covers the fundamental concepts in programming languages.
While we will be using several languages, the purpose of the text is
not to learn different languages. Instead, it is to learn the concepts
that will both facilitate learning a new language quickly and make
better use of the programming constructs that a programming language
provides. To analogize with spoken languages, the subject of this text
is more akin to linguistics rather than a specific language.</p>
<p>Topics that are covered in this text include programming-language
features for naming, control flow, and memory management, basic theory
of programming languages, such as grammars and type systems, and
various programming paradigms including functional, object-oriented,
and logic-programming techniques. We will also consider advanced
programming techniques such as generic programming and code
generation.</p>
<section id="introduction">
<h1>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h1>
<blockquote class="epigraph">
<div><p>There are no solutions; there are only trade-offs.
— <a class="reference external" href="https://en.wikipedia.org/wiki/A_Conflict_of_Visions">Thomas Sowell</a></p>
</div></blockquote>
<p>A programming language is a language designed for expressing computer
programs at a higher level than a machine language. While many
programmers consider programming languages such as C to be more powerful
than assembly, and higher-level languages such as C++ and Python to be
more powerful than C, in reality, all languages can solve exactly the
same problems. This perceived power differential is due to the set of
abstractions each language provides, and to what degree a language
facilitates programming in different paradigms and patterns.</p>
<p>There are countless programming languages in existence. A <a class="reference external" href="https://en.wikipedia.org/wiki/List_of_programming_languages">list of
notable languages on Wikipedia</a>
enumerates over 700 languages. If all languages can solve the same
problems, why are there so many languages?</p>
<figure class="align-center" id="id8">
<a class="reference internal image-reference" href="_images/standards.svg"><img alt="_images/standards.svg" src="_images/standards.svg" width="720" /></a>
<figcaption>
<p><span class="caption-number">Figure 1 </span><span class="caption-text">Credit: <a class="reference external" href="http://xkcd.com/">xkcd</a></span><a class="headerlink" href="#id8" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>A language occupies a point in the space of tradeoffs between
different design goals. These include ease of writing code,
readability, performance, maintainability, portability, modularity,
safety, and many other considerations. It is impossible to optimize
for all these goals simultaneously. Instead, they must be balanced
according to the intended use of a language.</p>
<p>A language may also be intended for a specific problem domain and
therefore support target design goals and abstractions that are
important to that domain. A concrete example is Fortran, which is
suited to numerical computations by providing a multidimensional array
abstraction with excellent performance.</p>
<p>Programming languages are often designed with a particular language
paradigm in mind. One such paradigm is <em>imperative programming</em>, where a
program is decomposed into explicit computational steps in the form of
<em>statements</em>. Another general pattern is <em>declarative programming</em>,
where computation is expressed in terms of <em>what</em> it should accomplish
rather than <em>how</em>. More specific styles within this space include
<em>functional programming</em>, which models computation after mathematical
functions and avoids mutation, and <em>logic programming</em>, which
expresses a program in the form of facts and rules. One last example
is <em>object-oriented programming</em>, which organizes data into <em>objects</em>
and computation into <em>methods</em> that are associated with those objects.
These language paradigms are not mutually exclusive, and higher-level
languages often support a combination of paradigms.</p>
<p>Languages also differ in the design of their <em>type systems</em>. Entities
in a programming language are generally associated with a type, which
determines what operations are valid on those entities and how to
perform those operations. Two common methodologies are <em>static
typing</em>, in which types are inferred directly from a program’s source
code and checked at compile time, and <em>dynamic typing</em>, where types
are tracked and checked at runtime. Often languages use a combination
of these systems, such as with dynamic casting in C++.</p>
<p>A final consideration in designing and implementing a language is
whether it is intended to be <em>compiled</em> or <em>interpreted</em>. In
compilation, a program is transformed from its original code into a
form that is more suited to direct execution on a particular system.
This usually occurs separately from running the program, and the
translation need only be done once for a program on a specific system.
In contrast, interpreting code entails simulating its execution at
runtime, which generally results in lower performance than
compilation. However, interpreters can enable greater flexibility than
compilers, since the original code is available and program state is
more easily accessible. Modern languages often use a combination of
compilation and interpretation.</p>
<p>A common aspect of these design areas is that they do not consist of
discrete choices. Rather, they present a continuum between different
canonical choices, and programming languages often fall somewhere
along that continuum. When we say that a language, for instance, is
statically typed, in actuality we mean that the predominant form of
type checking is static, even though the language may have some
elements of dynamic typing.</p>
</section>
<section id="basic-python">
<h1>Basic Python<a class="headerlink" href="#basic-python" title="Link to this heading"></a></h1>
<blockquote class="epigraph">
<div><p>A language isn’t something you learn so much as something you join.
— <a class="reference external" href="http://arikaokrent.com/">Arika Okrent</a></p>
</div></blockquote>
<p>Python is a widely used programming language that supports many
programming paradigms and has numerous libraries in a wide variety of
application domains. We will use Python, along with other languages,
to explore the design space of programming languages. While some
systems come with a version of Python already installed, in this
text, we will be using the most recent <a class="reference external" href="https://docs.python.org/3/">stable release of Python 3</a>. Installation packages can be found on
the <a class="reference external" href="https://www.python.org/downloads/">downloads page of the Python website</a>.</p>
<p>Python is an interpreted language, and a good way to gain familiarity
with Python is to start the interpreter and interact with it directly.
In order to start up the interpreter, you will need to go to your
command prompt and type <code class="docutils literal notranslate"><span class="pre">python</span></code>, <code class="docutils literal notranslate"><span class="pre">python3</span></code> or <code class="docutils literal notranslate"><span class="pre">python3.5</span></code>
depending on how many versions are installed on your machine.
Depending on the operating system you are using, you might also have
to modify your PATH.</p>
<p>Starting the interpreter will bring up the <code class="docutils literal notranslate"><span class="pre">&gt;&gt;&gt;</span></code> prompt, allowing you
to type code directly into the interpreter. When you press enter, the
Python interpreter will interpret the code you typed, or if the code is
syntactically incomplete, wait for more input. Upon evaluating an
expression, the interactive interpreter will display the evaluation
result, unless evaluation resulted in the special <code class="docutils literal notranslate"><span class="pre">None</span></code> value.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="mi">3</span> <span class="o">+</span> <span class="mi">4</span>
<span class="go">7</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">abs</span><span class="p">(</span><span class="o">-</span><span class="mf">2.1</span><span class="p">)</span>
<span class="go">2.1</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kc">None</span>
</pre></div>
</div>
<p>Each session keeps a history of what you have typed. To access that
history, press <code class="docutils literal notranslate"><span class="pre">&lt;Control&gt;-P</span></code> (previous) and <code class="docutils literal notranslate"><span class="pre">&lt;Control&gt;-N</span></code> (next).
<code class="docutils literal notranslate"><span class="pre">&lt;Control&gt;-D</span></code> exits a session, which discards this history. Up and
down arrows also cycle through history on some systems.</p>
<section id="variables">
<h2>Variables<a class="headerlink" href="#variables" title="Link to this heading"></a></h2>
<p>Variables in Python do not have a static type. They are introduced
by assigning a value to a name:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Binding a variable to a value of one type does not preclude binding it
to a value of a different type later on:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mi">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="s1">&#39;hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">&#39;hello&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="mf">4.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">4.1</span>
</pre></div>
</div>
<p>Multiple variables can be assigned to in a single statement using a
comma to separate names on the left-hand side and values on the
right-hand side:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="go">5.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z</span>
<span class="go">6.1</span>
</pre></div>
</div>
</section>
<section id="basic-data-structures">
<h2>Basic Data Structures<a class="headerlink" href="#basic-data-structures" title="Link to this heading"></a></h2>
<p>Multiple assignment is actually an example of using a <em>tuple</em>, which
is an immutable compound data type. In the context of programming
languages, something is immutable if its state cannot be changed after
it was first created. A tuple is constructed by separating values by
commas, and then optionally surrounding the values with parentheses.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span>
<span class="go">(3, 4)</span>
</pre></div>
</div>
<p>Individual elements of a tuple can be accessed with square brackets.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">4</span>
</pre></div>
</div>
<p>Negative indices access a container in reverse, with -1 corresponding
to the last element:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">4</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
<span class="go">3</span>
</pre></div>
</div>
<p>Lists are mutable containers, and they are constructed using square
brackets around the values.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">[5, 6]</span>
</pre></div>
</div>
<p>Unlike tuples, list elements can be modified, and new elements can be appended to the
end of a list:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span>
<span class="go">[5, 7, 8]</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">dir</span></code> function can be used to inspect the full interface of the
<code class="docutils literal notranslate"><span class="pre">list</span></code> type:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">dir</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
<span class="go">[&#39;__add__&#39;, &#39;__class__&#39;, &#39;__contains__&#39;, &#39;__delattr__&#39;, &#39;__delitem__&#39;,</span>
<span class="go">&#39;__delslice__&#39;, &#39;__doc__&#39;, &#39;__eq__&#39;, &#39;__format__&#39;, &#39;__ge__&#39;,</span>
<span class="go">&#39;__getattribute__&#39;, &#39;__getitem__&#39;, &#39;__getslice__&#39;, &#39;__gt__&#39;,</span>
<span class="go">&#39;__hash__&#39;, &#39;__iadd__&#39;, &#39;__imul__&#39;, &#39;__init__&#39;, &#39;__iter__&#39;, &#39;__le__&#39;,</span>
<span class="go">&#39;__len__&#39;, &#39;__lt__&#39;, &#39;__mul__&#39;, &#39;__ne__&#39;, &#39;__new__&#39;, &#39;__reduce__&#39;,</span>
<span class="go">&#39;__reduce_ex__&#39;, &#39;__repr__&#39;, &#39;__reversed__&#39;, &#39;__rmul__&#39;,</span>
<span class="go">&#39;__setattr__&#39;, &#39;__setitem__&#39;, &#39;__setslice__&#39;, &#39;__sizeof__&#39;, &#39;__str__&#39;,</span>
<span class="go">&#39;__subclasshook__&#39;, &#39;append&#39;, &#39;count&#39;, &#39;extend&#39;, &#39;index&#39;, &#39;insert&#39;,</span>
<span class="go">&#39;pop&#39;, &#39;remove&#39;, &#39;reverse&#39;, &#39;sort&#39;]</span>
</pre></div>
</div>
<p>Documentation of a particular method can be retrieved with the
<code class="docutils literal notranslate"><span class="pre">help</span></code> function:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">help</span><span class="p">(</span><span class="nb">list</span><span class="o">.</span><span class="n">append</span><span class="p">)</span>
<span class="go">Help on method_descriptor:</span>
<span class="go">append(...)</span>
<span class="go">    L.append(object) -- append object to end</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">dict</span></code> (short for <em>dictionary</em>) is an associative container that
maps a key to a value. It is created by enclosing key-value pairs
within curly braces.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">d</span> <span class="o">=</span> <span class="p">{</span> <span class="mi">1</span> <span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;hello&#39;</span> <span class="p">:</span> <span class="s1">&#39;world&#39;</span> <span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span>
<span class="go">{1: 2, &#39;hello&#39;: &#39;world&#39;}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">d</span><span class="p">[</span><span class="s1">&#39;hello&#39;</span><span class="p">]</span>
<span class="go">&#39;world&#39;</span>
</pre></div>
</div>
<p>Strings are denoted by either single or double quotes. A common
convention is to use single quotes unless the string contains a single
quote as one of its characters.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;hello world&#39;</span>
<span class="go">&#39;hello world&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s2">&quot;hello world&quot;</span>
<span class="go">&#39;hello world&#39;</span>
</pre></div>
</div>
<p>Furthermore, A string can span multiple lines if it is enclosed in
triple quotes. For example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="gp">... </span><span class="s2">Hello</span>
<span class="gp">... </span><span class="s2">World!</span>
<span class="gp">... </span><span class="s2">&quot;&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">&#39;\nHello\nWorld!\n&#39;</span>
</pre></div>
</div>
<p>Where <code class="docutils literal notranslate"><span class="pre">\n</span></code> is the newline character.</p>
</section>
<section id="compound-statements">
<h2>Compound Statements<a class="headerlink" href="#compound-statements" title="Link to this heading"></a></h2>
<p>In Python, a sequence of statements, also called a <em>suite</em>, consists
of one or more statements preceded by the same indentation. Unlike
other languages, such as C++, indentation is meaningful, and
inconsistent indentation is a syntax error. Common convention in
Python is to use four spaces per indentation level. Avoid using tabs,
as they are not visually distinguishable from spaces but are
considered distinct by the interpreter.</p>
<p>A conditional statement is composed of an <code class="docutils literal notranslate"><span class="pre">if</span></code> clause, zero or more
<code class="docutils literal notranslate"><span class="pre">elif</span></code> clauses, and an optional <code class="docutils literal notranslate"><span class="pre">else</span></code> clause:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">&lt;</span><span class="n">expression</span><span class="o">&gt;</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">suite</span><span class="o">&gt;</span>
<span class="k">elif</span> <span class="o">&lt;</span><span class="n">expression</span><span class="o">&gt;</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">suite</span><span class="o">&gt;</span>
<span class="k">else</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">suite</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>A suite must be indented further than its header, and each statement
in the suite must have the same indentation. Each header must end with
a colon. The conditional expression need not be parenthesized.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">if</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
<span class="go">        print(&#39;greater than&#39;)</span>
<span class="go">    elif pow(2, 3) == 5:</span>
<span class="go">        print(&#39;equal&#39;)</span>
<span class="go">    else:</span>
<span class="go">        print(&#39;less than&#39;)</span>
<span class="go">greater than</span>
</pre></div>
</div>
<p>While loops have similar syntax:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="o">&lt;</span><span class="n">expression</span><span class="o">&gt;</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">suite</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>For loops iterate over a sequence, similar to the range-based for
loop in C++:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="o">&lt;</span><span class="n">variable</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">sequence</span><span class="o">&gt;</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">suite</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]:</span>
<span class="go">        print(i)</span>
<span class="go">3</span>
<span class="go">4</span>
<span class="go">5</span>
</pre></div>
</div>
</section>
<section id="function-definitions">
<h2>Function Definitions<a class="headerlink" href="#function-definitions" title="Link to this heading"></a></h2>
<p>A function is defined with the <code class="docutils literal notranslate"><span class="pre">def</span></code> statement:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="o">&lt;</span><span class="n">function</span><span class="o">&gt;</span><span class="p">(</span><span class="o">&lt;</span><span class="n">arguments</span><span class="o">&gt;</span><span class="p">):</span>
    <span class="o">&lt;</span><span class="n">suite</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>In keeping with Python’s lack of static typing, the return and
argument types are not specified.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">square</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
<span class="go">        return x * x</span>
</pre></div>
</div>
<p>If a function does not explicitly return a value when it is called,
then it returns the special <code class="docutils literal notranslate"><span class="pre">None</span></code> value.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">print_twice</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
<span class="go">        print(s)</span>
<span class="go">        print(s)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">print_twice</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="go">3</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">None</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">def</span></code> statement binds a function object to the given name. Unlike
in some other languages, this name can be rebound to something else.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">print_twice</span>
<span class="go">&lt;function print_twice at 0x103e0e488&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_twice</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_twice</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_twice</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
  File <span class="nb">&quot;&lt;stdin&gt;&quot;</span>, line <span class="m">1</span>, in <span class="n">&lt;module&gt;</span>
<span class="gr">TypeError</span>: <span class="n">&#39;int&#39; object is not callable</span>
</pre></div>
</div>
<p>In Python, definitions are actually executed when they are
encountered. For a function definition, this creates a new function
object and binds it to the name specified in the definition.</p>
</section>
<section id="class-definitions">
<h2>Class Definitions<a class="headerlink" href="#class-definitions" title="Link to this heading"></a></h2>
<p>A class is defined with a <code class="docutils literal notranslate"><span class="pre">class</span></code> statement:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>class &lt;name&gt;(&lt;base classes&gt;):
    &lt;suite&gt;
</pre></div>
</div>
<p>The list of base classes can be elided, in which case the base class
is <code class="docutils literal notranslate"><span class="pre">object</span></code>.</p>
<p>When defining an instance method in Python, the definition explicitly
takes in <code class="docutils literal notranslate"><span class="pre">self</span></code> as the first parameter. When the method is called,
the receiving object is implicitly passed in to this first parameter.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Cat</span><span class="p">:</span>
<span class="go">        def speak(self):</span>
<span class="go">            print(&#39;meow&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Cat</span><span class="p">()</span><span class="o">.</span><span class="n">speak</span><span class="p">()</span>
<span class="go">meow</span>
</pre></div>
</div>
<p>The constructor is defined using the special <code class="docutils literal notranslate"><span class="pre">__init__</span></code> method.
Member variables, more properly called <em>attributes</em> in Python, are
introduced using the <code class="docutils literal notranslate"><span class="pre">self</span></code> parameter and dot syntax.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Square</span><span class="p">:</span>
<span class="go">        def __init__(self, side_length):</span>
<span class="go">            self.side = side_length</span>
<span class="go">        def perimeter(self):</span>
<span class="go">            return 4 * self.side</span>
<span class="go">        def area(self):</span>
<span class="go">            return self.side * self.side</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">Square</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">perimeter</span><span class="p">()</span>
<span class="go">12</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span><span class="o">.</span><span class="n">area</span><span class="p">()</span>
<span class="go">9</span>
</pre></div>
</div>
</section>
<section id="modules">
<h2>Modules<a class="headerlink" href="#modules" title="Link to this heading"></a></h2>
<p>Python has a number of built-in libraries organized as modules,
and an individual <code class="docutils literal notranslate"><span class="pre">.py</span></code> file also represents a module. Modules
can be loaded using the <code class="docutils literal notranslate"><span class="pre">import</span></code> statement:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="o">&lt;</span><span class="n">modules</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This binds module objects to their corresponding names in the
current environment, which can then be used to access an attribute
of a module.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">operator</span><span class="o">,</span> <span class="nn">math</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">math</span><span class="o">.</span><span class="n">pow</span><span class="p">(</span><span class="n">operator</span><span class="o">.</span><span class="n">mul</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span>
<span class="go">36.0</span>
</pre></div>
</div>
<p>Individual attributes of a module can also be introduced into
the environment using another form of the import statement:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span> <span class="kn">import</span> <span class="o">&lt;</span><span class="n">attributes</span><span class="o">&gt;</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="nb">pow</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">8</span>
</pre></div>
</div>
<p>Another variant imports all names from a module:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">operator</span> <span class="kn">import</span> <span class="o">*</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mul</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="go">6</span>
</pre></div>
</div>
</section>
<section id="executing-a-module">
<h2>Executing a Module<a class="headerlink" href="#executing-a-module" title="Link to this heading"></a></h2>
<p>Python does not specify a special <code class="docutils literal notranslate"><span class="pre">main</span></code> function like the C family
of languages. Instead, all code in a module is interpreted when it
is loaded, starting from the top.</p>
<p>It is possible to specify a piece of code that does not run when a
module is imported, but runs when a module is executed directly at the
command-line, as in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">program</span><span class="o">.</span><span class="n">py</span> <span class="o">&lt;</span><span class="n">arguments</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This is accomplished by checking if the <code class="docutils literal notranslate"><span class="pre">__name__</span></code> attribute is
set to <code class="docutils literal notranslate"><span class="pre">'__main__'</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">suite</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The suite will only be executed if the module is executed on the
command-line.</p>
<p>Command-line arguments can be obtained using the <code class="docutils literal notranslate"><span class="pre">argv</span></code> list in the
<code class="docutils literal notranslate"><span class="pre">sys</span></code> module. As in C and C++, the first argument is the name of the
program.</p>
</section>
<section id="python-reference-semantics">
<h2>Python Reference Semantics<a class="headerlink" href="#python-reference-semantics" title="Link to this heading"></a></h2>
<p>A variable in Python is actually an indirect <em>reference</em> to an object,
rather than holding the object directly in the variable’s memory
location. Thus, a Python variable is analogous to a C++ pointer, and
assigning from one variable to another merely copies the indirect
reference rather than copying the object. The following example
illustrates this:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[3]</span>
</pre></div>
</div>
<p>The assignment <code class="docutils literal notranslate"><span class="pre">y</span> <span class="pre">=</span> <span class="pre">x</span></code> results in both <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> referring to
the same list object, so that the <code class="docutils literal notranslate"><span class="pre">x</span></code> reference reflects the
modification to the list that was made through the <code class="docutils literal notranslate"><span class="pre">y</span></code> reference.
Thus, an assignment does not make a copy of an object. To copy an
object, we can use the <code class="docutils literal notranslate"><span class="pre">copy()</span></code> function in the <code class="docutils literal notranslate"><span class="pre">copy</span></code> module (or
the <code class="docutils literal notranslate"><span class="pre">deepcopy()</span></code> function in the same module if we want a deep
rather than a shallow copy). Alternatively, many types can be copied
by invoking the constructor with an existing object, as in the
following:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="o">-</span><span class="mi">7</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span>
<span class="go">[3, -7]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span>
<span class="go">[3]</span>
</pre></div>
</div>
<p>We will discuss <a class="reference internal" href="#value-and-reference-semantics"><span class="std std-ref">reference semantics</span></a> in more detail later.</p>
</section>
</section>
<section id="basic-elements">
<h1>Basic Elements<a class="headerlink" href="#basic-elements" title="Link to this heading"></a></h1>
<p>A programming language is a formal system for expressing computation.
Any formal language, whether natural, mathematical, or programming,
has rules that specify what sequences of symbols are meaningful in the
language. We will see many of the rules that govern a programming
language throughout this text, but we begin with the basic elements
that comprise a program.</p>
<section id="levels-of-description">
<h2>Levels of Description<a class="headerlink" href="#levels-of-description" title="Link to this heading"></a></h2>
<p>A language, whether a spoken language or a programming language, can be
described at multiple levels of abstraction, from how the most basic
pieces of the language can be formed, to how they can be combined to
construct meaningful phrases, to how those phrases can be used to
accomplish a purpose. The following are the levels we consider when it
comes to a programming language:</p>
<ul class="simple">
<li><p><em>Grammar</em> determines what phrases are correct. It can be further
divided into <em>lexical structure</em>, which defines how the words of the
language are constructed, and <em>syntax</em>, which determines what
sequences of words form correct phrases.</p></li>
<li><p><em>Semantics</em> specify the meaning of a correct phrase.</p></li>
<li><p><em>Pragmatics</em> are concerned with the practical use of correct
phrases. In programming languages, this includes common design
patterns and programming practices.</p></li>
<li><p>An <em>implementation</em> determines how the actions specified by a
meaningful phrase are accomplished. This level of description is
unique to programming languages, which we use to write programs that
perform actual tasks that need to be done.</p></li>
</ul>
<p>We proceed to take a closer look at the first two levels of
description. We will consider the latter two levels later.</p>
<section id="lexical-structure">
<h3>Lexical Structure<a class="headerlink" href="#lexical-structure" title="Link to this heading"></a></h3>
<p>The <em>lexical structure</em> of a language determines what constitutes the
words that are in the language, more commonly called <em>tokens</em> in the
context of programming languages. Valid characters are defined by the
alphabet, generally ASCII or Unicode in a programming language, and
tokens are composed of one or more consecutive characters. Tokens are
often separated by whitespace, and a token also ends if it is followed
by a character that is invalid for the token.</p>
<p>The classes of tokens depend on the particular language, but common
classes are identifiers, keywords, literals, operators, and
separators.</p>
<p>A <em>literal</em> represents a particular value directly in source code.
Literals include integer and floating-point numbers, booleans,
characters, and strings. Often a language provides different literal
representations for each primitive type. For example, C++ includes
<code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">long</span></code>, and <code class="docutils literal notranslate"><span class="pre">long</span> <span class="pre">long</span></code> integer literals by using the
<code class="docutils literal notranslate"><span class="pre">l</span></code> and <code class="docutils literal notranslate"><span class="pre">ll</span></code> suffixes for the latter two. A language may also
support different representations for literals of a particular type,
such as decimal, hexadecimal, octal, and binary integer literals. Some
languages, such as C++11, even allow user-defined literals that can
represent arbitrary types.</p>
<p><em>Operators</em> such as <code class="docutils literal notranslate"><span class="pre">+</span></code> and <code class="docutils literal notranslate"><span class="pre">==</span></code> are commonly defined as special
tokens. However, some languages such as Scheme do not treat operators
as special; instead, they are considered to be identifiers.</p>
<p>An <em>identifier</em> is a sequence of characters that can be used to name
entities in a program. In languages such as Python and C++, an
identifier begins with a letter or underscore and can subsequently
contain letters, underscores, and digits. Java allows identifiers to
contain the dollar sign (<code class="docutils literal notranslate"><span class="pre">$</span></code>) symbol, though general practice is to
reserve it for machine-generated names. Scheme allows many more
symbols to be part of an identifier. Most languages are case
sensitive in that capitalization is significant. However, some other
languages, such as Scheme, treat identifiers in a case-insensitive
manner.</p>
<p>A <em>keyword</em> is a sequence of characters that has the form of an
identifier but has special meaning in the language, such as the token
<code class="docutils literal notranslate"><span class="pre">if</span></code> in many languages. Depending on the language, a keyword can be
forbidden from being used as a name, or its meaning can be determined
based on context.</p>
<p><em>Separators</em>, also called <em>delimiters</em> or <em>punctuators</em>, are the
punctuation of a language, denoting the boundary between programmatic
constructs or their components. Common separators include parentheses,
curly braces, commas, and semicolons. In some cases, a token may act
as a separator or as an operator depending on the context, such as a
comma in C and C++.</p>
<p>The lexical structure of a language is usually specified using regular
expressions, and breaking source code into tokens is often the first
step in compiling or interpreting a program. The particulars of
regular expressions will be discussed later on in this text.</p>
</section>
<section id="syntax">
<h3>Syntax<a class="headerlink" href="#syntax" title="Link to this heading"></a></h3>
<p>The <em>syntax</em> of a language specifies what sequences of tokens
constitute valid fragments of the language. Syntax concerns only the
structure of a program; source code may be syntactically correct but
semantically invalid, resulting in an invalid program.</p>
<p>An example of a syntactic rule is that parentheses must be balanced
within a code fragment. For example, the following code consists of
valid tokens in C++ but is not syntactically valid:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">;</span>
</pre></div>
</div>
<p>Another example of a syntax rule is that consecutive identifiers are
generally illegal in Python or C++ (declarations being an exception in
the latter).</p>
<p>The syntax rules of a language are specified using a formal grammar,
a topic we will return to later in the text.</p>
</section>
<section id="semantics">
<h3>Semantics<a class="headerlink" href="#semantics" title="Link to this heading"></a></h3>
<p>Whereas syntax is concerned with the structure of code fragments,
<em>semantics</em> determines the meaning of a code fragment. In
particular, it indicates what value is computed or what action is
taken by a code fragment.</p>
<p>Defining a programming language requires assigning semantics to each
syntactic construct in the language. As we will see later, there are
formal methods for describing the semantics of a construct. However,
given the complexity of most languages and the fact that most
programmers are not trained in formal semantics, semantics are
often described using natural language.</p>
<p>Semantics further restrict what constitutes valid code. For example,
the following is syntactically correct in C++ but semantically
invalid:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="n">x</span><span class="p">.</span><span class="n">foo</span><span class="p">();</span><span class="w"> </span><span class="c1">// invalid</span>
</pre></div>
</div>
</section>
</section>
<section id="entities-objects-and-variables">
<h2>Entities, Objects, and Variables<a class="headerlink" href="#entities-objects-and-variables" title="Link to this heading"></a></h2>
<p>An <em>entity</em>, also called a <em>citizen</em> or <em>object</em> (though we use the
latter term more specifically, as defined below), denotes something
that can be named in a program. Examples include types, functions,
data objects, and values.</p>
<p>A <em>first-class entity</em> is an entity that supports all operations
generally available to other entities, such as being associated with a
variable, passed as an argument, returned from a function, and created
at runtime. The set of first-class entities differs between
programming languages. For example, functions and types are
first-class entities in Python, but not in C++ or Java. (Functions in
C++ have many of the characteristics of first-class entities, but they
cannot be created dynamically, so they are not quite first class.)
Control of execution may also be a first-class entity, as we will see
in <a class="reference internal" href="functional.html#continuations"><span class="std std-ref">Continuations</span></a>. <a class="reference internal" href="#table-first-class"><span class="std std-numref">Table 1</span></a>
summarizes the first-class entities in C++, Java, Python, and Scheme.</p>
<span id="table-first-class"></span><table class="docutils align-default" id="id9">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">First-class entities in C++, Java, Python, and Scheme.</span><a class="headerlink" href="#id9" title="Link to this table"></a></caption>
<thead>
<tr class="row-odd"><th class="head"></th>
<th class="head"><p>C++</p></th>
<th class="head"><p>Java</p></th>
<th class="head"><p>Python</p></th>
<th class="head"><p>Scheme</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Functions</p></td>
<td><p>no (almost)</p></td>
<td><p>no</p></td>
<td><p>yes</p></td>
<td><p>yes</p></td>
</tr>
<tr class="row-odd"><td><p>Types</p></td>
<td><p>no</p></td>
<td><p>no</p></td>
<td><p>yes</p></td>
<td><p>no</p></td>
</tr>
<tr class="row-even"><td><p>Control</p></td>
<td><p>no</p></td>
<td><p>no</p></td>
<td><p>no</p></td>
<td><p>yes</p></td>
</tr>
</tbody>
</table>
<p>An <em>object</em> is a location in memory that holds a value. An object may
be modifiable, in which case the value it holds may change, or it may
be constant. A <em>variable</em> is a name paired with an object. In some
languages, multiple names may be associated with the same object, in
which case the names are said to <em>alias</em> the same object.</p>
<p>An object has a <em>lifetime</em> during which it is valid to use that object
while a variable has a <em>scope</em>, which specifies the parts of a program
that have access to that variable. An object also has a <em>type</em> that
determines what its data represents and the operations that the object
supports. We will examine these concepts in more detail later on.</p>
</section>
<section id="l-values-and-r-values">
<h2>L-Values and R-Values<a class="headerlink" href="#l-values-and-r-values" title="Link to this heading"></a></h2>
<p>An object actually has two values associated with it: its memory
location and the contents of that memory location. The former is
called an <em>l-value</em> while the latter is an <em>r-value</em>, after the fact
that they are generally used on the left-hand side and right-hand side
of an assignment, respectively. Most languages implicitly convert
l-values to r-values when necessary.</p>
<p>As a concrete example, consider an integer variable <code class="docutils literal notranslate"><span class="pre">x</span></code>:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
</pre></div>
</div>
<p>The name <code class="docutils literal notranslate"><span class="pre">x</span></code> denotes a memory location that is initialized to hold
the value <code class="docutils literal notranslate"><span class="pre">3</span></code>. When the name <code class="docutils literal notranslate"><span class="pre">x</span></code> is evaluated, the result is an
l-value. However, it is automatically converted to an r-value in the
following definition:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
</pre></div>
</div>
<p>The initialization of the variable <code class="docutils literal notranslate"><span class="pre">y</span></code> requires an r-value, so <code class="docutils literal notranslate"><span class="pre">x</span></code>
is converted to its r-value <code class="docutils literal notranslate"><span class="pre">3</span></code>. On the other hand, in the following
assignment, an l-value is required on the left-hand side:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
</pre></div>
</div>
<p>The left-hand side evaluates to the memory location denoted by <code class="docutils literal notranslate"><span class="pre">x</span></code>
and changes its contents to the r-value <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p>
<p>Temporary objects, such as the result of <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">+</span> <span class="pre">3</span></code>, have r-values but
do not necessarily have l-values. Most languages do not allow access
to a temporary’s l-value even if it has one.</p>
<p>We will return to l-values and r-values when we discuss <a class="reference internal" href="#value-and-reference-semantics">value and
reference semantics</a>.</p>
</section>
<section id="expressions">
<span id="id1"></span><h2>Expressions<a class="headerlink" href="#expressions" title="Link to this heading"></a></h2>
<p>An <em>expression</em> is a syntactic construct that results in a value. An
expression is <em>evaluated</em> to produce the resulting value.</p>
<p>The simplest expressions are literals, which evaluate to the value
they represent, and identifiers, which evaluate to the l-value or
r-value of the corresponding object, assuming that a variable is in
scope that associates the identifier with an object.</p>
<p>Simple expressions can be combined to form <em>compound expressions</em>
according to the rules defined by a language. Combinators include
operators such as <code class="docutils literal notranslate"><span class="pre">+</span></code> or <code class="docutils literal notranslate"><span class="pre">.</span></code>. A function call is also generally a
compound expression, as in:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hello&quot;</span><span class="p">,</span> <span class="s2">&quot;world&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Depending on the language, the functor itself (<code class="docutils literal notranslate"><span class="pre">print</span></code> in the
example above) can be an expression. Each argument is also an
expression.</p>
<p>Operators have <em>precedence</em> rules that determine how subexpressions
are grouped when multiple operators are involved. For example, the
following expression typically evaluates to 7 in languages that have
infix operators, since <code class="docutils literal notranslate"><span class="pre">*</span></code> has higher precedence than <code class="docutils literal notranslate"><span class="pre">+</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="mi">3</span>
</pre></div>
</div>
<p>Infix languages generally allow subexpressions to be explicitly grouped
using parentheses:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="mi">3</span>
</pre></div>
</div>
<p>An operator also has an <em>associativity</em> that determines how its
operands group when there are multiple operators of the same
precedence. Binary operators typically associate from left to right,
while unary operators generally have right associativity. A notable
exception are assignment operators in languages such as C++, which
associate right to left. This allows expressions such as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">a</span> <span class="o">=</span> <span class="n">b</span> <span class="o">=</span> <span class="n">c</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>This is equivalent to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">c</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)))</span>
</pre></div>
</div>
<p>So the end result is that all of <code class="docutils literal notranslate"><span class="pre">a</span></code>, <code class="docutils literal notranslate"><span class="pre">b</span></code>, and <code class="docutils literal notranslate"><span class="pre">c</span></code> are assigned
the value 0.</p>
<p>In addition to defining how subexpressions are grouped together, the
language must specify the order in which those subexpressions are
evaluated. In many languages, such as Python and Java, subexpressions
are generally evaluated in order from left to right. In Scheme, C, and
C++, however, order of evaluation is left up to the implementation in
many cases. Consider the following example in C++:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">++</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>With C++14 and earlier, this code can result in <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">3</span></code> or <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">4</span></code>
being printed, depending on the implementation. C++17 modified the
order-of-evaluation rules such that this code always results in <code class="docutils literal notranslate"><span class="pre">4</span>
<span class="pre">4</span></code>, though there are other cases were the order of evaluation is
still left to the implementation (e.g. the order in which arguments to
a function call are evaluated).</p>
</section>
<section id="statements">
<h2>Statements<a class="headerlink" href="#statements" title="Link to this heading"></a></h2>
<p>In addition to expressions, imperative programming languages also have
<em>statements</em>, which specify some action to be carried out but do not
produce a value. Thus, a statement is <em>executed</em> rather than
evaluated. Statements usually modify the state of a program or the
underlying system. These modifications are called <em>side effects</em>.</p>
<p>The syntax of a language determines what constitutes a statement. In
the C family of languages, a simple statement is terminated by a
semicolon, while in Python, a newline terminates a simple statement.
The following are examples of simple statements in C++:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">);</span>
<span class="n">a</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="k">return</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="k">break</span><span class="p">;</span>
<span class="k">goto</span><span class="w"> </span><span class="n">some_label</span><span class="p">;</span>
</pre></div>
</div>
<p>Languages also provide syntax for constructing <em>compound statements</em>
out of simpler statements and expressions. In C-like languages, a
<em>block</em> is a compound statement composed of a set of curly braces
surrounding a suite of zero or more statements:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">  </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Conditionals and loops are also compound statements, whether they
have a block or just an individual statement as a body.</p>
<p>Some languages make a distinction between statements, declarations,
and definitions, since the latter two may not be executed at runtime.
A <em>declaration</em> introduces a name into a program, as well as
properties about the entity it refers to, such as whether it refers to
a function or data and what its type is. A <em>definition</em> additionally
specifies the data or code that the name refers to. In Java, every
declaration is also a definition, so the two terms are often used
interchangeably. In C and C++, however, a declaration need not be a
definition, as in the following:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">extern</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">z</span><span class="p">);</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SomeClass</span><span class="p">;</span>
</pre></div>
</div>
<p>Python does not have declarations, and definitions are statements
that are executed.</p>
</section>
</section>
<section id="names-and-environments">
<h1>Names and Environments<a class="headerlink" href="#names-and-environments" title="Link to this heading"></a></h1>
<p>Names are the most fundamental form of abstraction, providing a
mechanism to refer to anything from simple data values, to complex
sets of data and behavior in object-oriented programming, to entire
libraries in the form of modules.</p>
<p>An important principle is that the <em>scope</em> of a name, or region in
which the name maps to a particular entity, should have a restricted
context. For example, if a name defined within the implementation of
one function or module were to cause a conflict with a name defined in
another function or module, abstraction would be violated, since
implementation details affect outside code:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">bar</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Here, even though the name <code class="docutils literal notranslate"><span class="pre">x</span></code> is repeated, each introduction of the
name <code class="docutils literal notranslate"><span class="pre">x</span></code> should have a context that is restricted to the individual
functions.</p>
<p>Scope is a feature of source code, and it determines what entity a
name refers to within the source code. If the name refers to an object
whose value is not known until runtime, then the program must defer
part of the lookup process until runtime. The mapping of names to
objects in each scope region is tracked in a data structure called a
<em>frame</em> or <em>activation record</em>. The collective set of contexts active
in a program is called the <em>environment</em>. A name is <em>bound</em> to an
object in a frame or environment if the frame maps that name to the
object.</p>
<p>Names that do not map to objects are generally not tracked in
activation records. Instead, the compiler or interpreter can determine
the entity that the name refers to from the source code itself.
However, due to the strong connection between scope regions and
frames, we often discuss the name-resolution process in the context of
frames, even if the actual lookup process happens at compile time.</p>
<p>Though a name is used as an abstraction for an entity, the name itself
is distinct from the entity it names. In particular, the same name can
refer to different entities in different code contexts, as in the
example above. A single entity may also have multiple names that refer
to it, as in the following C++ code:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="o">&amp;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="w">  </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="w">  </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w"> </span><span class="c1">// prints 4</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this example, both <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> refer to the same object at
runtime, so they alias each other.</p>
<p>Similarly, the same name can refer to different objects in different
<em>runtime</em> contexts:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">baz</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">baz</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">baz</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The names <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> defined in <code class="docutils literal notranslate"><span class="pre">baz()</span></code> refer to distinct pairs
of objects, with their own lifetimes, within the context of the two
separate calls to <code class="docutils literal notranslate"><span class="pre">baz()</span></code>.</p>
<p>Every language defines a set of built-in names that are available to
the programmer at program start. These include names for primitive
types, built-in functions or modules, and pre-defined constants. A
user can also introduce a name through a declaration or definition, as
discussed in the previous section.</p>
<p>It is also important to note that names are not actually necessary to
do computation. In fact, all programs could be written without names
(as with <a class="reference internal" href="theory.html#turing-machines"><span class="std std-ref">Turing machines</span></a>). Names, however,
provide an abstraction that is easily used and incredibly useful for
the programmer.</p>
<section id="blocks">
<h2>Blocks<a class="headerlink" href="#blocks" title="Link to this heading"></a></h2>
<p>Blocks are a fundamental unit of program organization common to most
languages. A <em>block</em> is a section of program text that contains name
bindings that are local to the block. Thus, a block corresponds to a
frame in the environment.</p>
<p>Languages generally have two types of blocks: a block that corresponds
to the body of a function, and an inline block that is not the body of
a function but is nested in another block. Some languages, such as
Python and Pascal, do not have inline blocks that contain their own
bindings.</p>
<p>The syntax that introduces a block depends on the language, though a
common feature is separate syntax that indicates the beginning and end
of a block. For example, in the ALGOL family, a block starts with
<code class="docutils literal notranslate"><span class="pre">begin</span></code> and ends with <code class="docutils literal notranslate"><span class="pre">end</span></code>, while in the C family, left and right
braces indicate the start and end of a block. An interesting case is
the Lisp family, including Scheme, which has special <code class="docutils literal notranslate"><span class="pre">let</span></code>
constructs to introduce a frame:</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">let</span><span class="w"> </span><span class="p">((</span><span class="nf">x</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nf">y</span><span class="w"> </span><span class="mi">4</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">display</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">))</span>
<span class="w">  </span><span class="p">(</span><span class="nb">display</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">))</span>
<span class="p">)</span>
</pre></div>
</div>
<p>This code first binds <code class="docutils literal notranslate"><span class="pre">x</span></code> to 3 and <code class="docutils literal notranslate"><span class="pre">y</span></code> to 4 and then prints their
sum and difference. As we will see later, this is generally
implemented by translating the <code class="docutils literal notranslate"><span class="pre">let</span></code> into a function that has
parameters <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>:</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">((</span><span class="k">lambda</span><span class="w"> </span><span class="p">(</span><span class="nf">x</span><span class="w"> </span><span class="nv">y</span><span class="p">)</span>
<span class="w">   </span><span class="p">(</span><span class="nb">display</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">))</span>
<span class="w">   </span><span class="p">(</span><span class="nb">display</span><span class="w"> </span><span class="p">(</span><span class="nb">-</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="nv">y</span><span class="p">))</span>
<span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">lambda</span></code> introduces an unnamed function, a concept we will
return to later. Thus, Lisp does not actually have inline blocks,
as any such blocks are really just function blocks.</p>
<p>Inline blocks are by definition nested inside other blocks, resulting
in inner frames that are enclosed by outer frames. This means that the
code inside the inner block exists in the context of multiple frames,
and a well-defined lookup procedure is required to determine the
meaning of a name.</p>
<p>Blocks associated with functions also result in nested frames, but
there are complications that arise, so we will defer discussion of
them until later.</p>
</section>
<section id="name-lookup">
<h2>Name Lookup<a class="headerlink" href="#name-lookup" title="Link to this heading"></a></h2>
<p>We first consider a general rule for how name lookup should proceed in
an environment with nested frames. Consider an environment that
consists of the frames <code class="docutils literal notranslate"><span class="pre">(A</span> <span class="pre">(B</span> <span class="pre">(C)))</span></code>, with <code class="docutils literal notranslate"><span class="pre">B</span></code> nested inside of
<code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">C</span></code> nested inside of <code class="docutils literal notranslate"><span class="pre">B</span></code>. This can result from code with
nested regions of scope, as in the following in C++:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="w"> </span><span class="o">**</span><span class="n">argv</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">   </span><span class="c1">// frame A</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span><span class="p">;</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">argc</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                   </span><span class="c1">// frame B</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">stoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">x</span><span class="p">]);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">y</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">                    </span><span class="c1">// frame C</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">argc</span><span class="p">;</span>
<span class="w">      </span><span class="kt">int</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x</span><span class="p">;</span><span class="w">                </span><span class="c1">// which x and y?</span>
<span class="w">      </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">z</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>What should the process be for looking up the name <code class="docutils literal notranslate"><span class="pre">x</span></code> in the
context of <code class="docutils literal notranslate"><span class="pre">C</span></code>? If the name <code class="docutils literal notranslate"><span class="pre">x</span></code> exists in only one of the active
frames <code class="docutils literal notranslate"><span class="pre">A</span></code>, <code class="docutils literal notranslate"><span class="pre">B</span></code>, or <code class="docutils literal notranslate"><span class="pre">C</span></code>, there is no possibility of ambiguity as
to which binding <code class="docutils literal notranslate"><span class="pre">x</span></code> refers to. On the other hand, if <code class="docutils literal notranslate"><span class="pre">x</span></code> is bound
in more than one frame, as in the example above, then a decision needs
to be made as to which binding it refers to. The standard rule is that
lookup prefers the innermost binding. Thus, since <code class="docutils literal notranslate"><span class="pre">x</span></code> is bound in
<code class="docutils literal notranslate"><span class="pre">C</span></code>, that binding is preferred even if though it is also bound in
<code class="docutils literal notranslate"><span class="pre">A</span></code>. On the other hand, <code class="docutils literal notranslate"><span class="pre">y</span></code> is not bound in <code class="docutils literal notranslate"><span class="pre">C</span></code>, so looking up
<code class="docutils literal notranslate"><span class="pre">y</span></code> in the context of <code class="docutils literal notranslate"><span class="pre">C</span></code> prefers the binding in <code class="docutils literal notranslate"><span class="pre">B</span></code> over the
one in <code class="docutils literal notranslate"><span class="pre">A</span></code>. Finally, looking up <code class="docutils literal notranslate"><span class="pre">argc</span></code> in <code class="docutils literal notranslate"><span class="pre">C</span></code> finds it in
neither <code class="docutils literal notranslate"><span class="pre">C</span></code> nor <code class="docutils literal notranslate"><span class="pre">B</span></code>, so the binding in <code class="docutils literal notranslate"><span class="pre">A</span></code> is used.</p>
<p>Thus, the standard lookup procedure is to search for a name in the
innermost frame (or scope) and only proceed to the next one if the
name is not found. This process is then recursively applied to that
next frame (or scope). We often illustrate this process by drawing
links between frames, as in <a class="reference internal" href="#figure-name-lookup"><span class="std std-numref">Figure 2</span></a>.</p>
<figure class="align-center" id="id10">
<span id="figure-name-lookup"></span><a class="reference internal image-reference" href="_images/name_lookup.svg"><img alt="_images/name_lookup.svg" src="_images/name_lookup.svg" width="400" /></a>
<figcaption>
<p><span class="caption-number">Figure 2 </span><span class="caption-text">An environment corresponding to a set of nested scopes.</span><a class="headerlink" href="#id10" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>A name is said to be <em>overloaded</em> if it refers to multiple entities in
the same scope. A language that allows overloading must specify
further rules on how the lookup process chooses between the applicable
entities. For example, in the case of overloaded function names, the
arguments of a function call can be compared to the parameter types of
each overload to determine which one is the most appropriate:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="kt">int</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="o">&amp;</span><span class="n">s</span><span class="p">);</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">foo</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span><span class="w">         </span><span class="c1">// calls foo(int x)</span>
<span class="w">  </span><span class="n">foo</span><span class="p">(</span><span class="s">&quot;hello&quot;</span><span class="p">);</span><span class="w">   </span><span class="c1">// calls foo(const string &amp;s)</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In some languages, name lookup takes into account how the name is used
in order to disambiguate between entities defined in <em>different</em>
scopes. For example, the following is valid Java code:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="kd">class</span> <span class="nc">SomeClass</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">main</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">    </span><span class="n">main</span><span class="p">(</span><span class="kc">null</span><span class="p">);</span><span class="w">   </span><span class="c1">// recursive call</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Even though the name <code class="docutils literal notranslate"><span class="pre">main</span></code> is defined in the innermost scope to be
a variable of type <code class="docutils literal notranslate"><span class="pre">int</span></code>, its use in a function call causes the
compiler to look for a function named <code class="docutils literal notranslate"><span class="pre">main</span></code>, disregarding the
variable of the same name. A candidate function is found in the
enclosing scope, so that is what the name-lookup procedure produces.</p>
</section>
<section id="nested-inline-blocks">
<h2>Nested Inline Blocks<a class="headerlink" href="#nested-inline-blocks" title="Link to this heading"></a></h2>
<p>Now that we have a general rule for looking up names in nested frames,
let us consider the environments that correspond to nested inline
blocks. Each block corresponds to a frame, resulting in an environment
with nested frames. The <em>visibility rules</em> of names within nested
blocks thus match the general rule discussed above. A name introduced
by a block is <em>visible</em> within a block nested inside of it, unless the
nested block redefines the name. In this case, the former binding is
<em>hidden</em> or <em>shadowed</em> by the latter.</p>
<p>Consider the following example in a C-like language:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="p">{</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The binding of <code class="docutils literal notranslate"><span class="pre">x</span></code> introduced by the outer block is not visible in
the inner block, since the inner block redefines the name <code class="docutils literal notranslate"><span class="pre">x</span></code>.
However, the binding of <code class="docutils literal notranslate"><span class="pre">y</span></code> is visible in the inner block, since
<code class="docutils literal notranslate"><span class="pre">y</span></code> is not redefined. Finally, the name <code class="docutils literal notranslate"><span class="pre">z</span></code> is only visible in the
inner block, since the outer block is not nested inside the inner.</p>
</section>
<section id="scope-in-functions">
<span id="static-scope"></span><h2>Scope in Functions<a class="headerlink" href="#scope-in-functions" title="Link to this heading"></a></h2>
<p>Functions introduce an element of choice that is not present in inline
blocks. An inline block is both textually nested inside an outer
block, and its execution takes place during the execution of the outer
block. On the other hand, the program text in which a function is
defined is distinct from the context in which it is called. Consider
the following code in a C-like language:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">bar</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">  </span><span class="n">foo</span><span class="p">();</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">foo()</span></code> is textually located at top-level, or <em>global</em>,
scope. However, it is called from within the block associated with the
function <code class="docutils literal notranslate"><span class="pre">bar()</span></code>. So which <code class="docutils literal notranslate"><span class="pre">x</span></code> is visible within <code class="docutils literal notranslate"><span class="pre">foo()</span></code>, and
what value is printed?</p>
<p>Either binding of <code class="docutils literal notranslate"><span class="pre">x</span></code>, and therefore either the value of 0 or 1, is
a valid choice depending on the sequence of frames that make up the
environment in <code class="docutils literal notranslate"><span class="pre">foo()</span></code>. The two choices are known as static
(lexical) scope and dynamic scope, and they are illustrated in
<a class="reference internal" href="#figure-static-dynamic-scope"><span class="std std-numref">Figure 3</span></a>.</p>
<figure class="align-center" id="id11">
<span id="figure-static-dynamic-scope"></span><a class="reference internal image-reference" href="_images/static_dynamic_scope.svg"><img alt="_images/static_dynamic_scope.svg" src="_images/static_dynamic_scope.svg" width="500" /></a>
<figcaption>
<p><span class="caption-number">Figure 3 </span><span class="caption-text">Environment structure in static and dynamic scope.</span><a class="headerlink" href="#id11" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Before considering each of the choices in more detail, let us define
some terminology common to both schemes. The <em>local environment</em> of a
function consists of the subset of the environment that is local to
the function. This includes parameter names and all names defined in
the context of the function body. The <em>global environment</em> consists of
names defined at the top-level of a program, either at global or
module scope depending on the language. Finally, the <em>non-local
environment</em> of a function consists of those names that are visible
from a function but are neither local to the function nor at global or
module scope. It is in what constitutes the non-local environment that
static and dynamic scope differ.</p>
<p>For both types, looking up a name follows the general rule we
introduced above; the local environment is checked first, followed by
the non-local environment, followed by the global environment.</p>
</section>
<section id="id2">
<h2>Static Scope<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<p>In <em>static</em> or <em>lexical</em> scope, the environment at any point in a
program can be deduced from the syntactic structure of the code,
without considering how the computation evolves at runtime. In this
scheme, the non-local environment of a function consists of those
non-global bindings that are visible in the program text in which the
function definition appears.</p>
<p>Considering the example above, the definition <code class="docutils literal notranslate"><span class="pre">int</span> <span class="pre">x</span> <span class="pre">=</span> <span class="pre">0</span></code> introduces
a binding of <code class="docutils literal notranslate"><span class="pre">x</span></code> into the global environment. The definition of
<code class="docutils literal notranslate"><span class="pre">foo()</span></code> is located in the context of the global frame, so it has no
non-local bindings. Therefore, the binding of <code class="docutils literal notranslate"><span class="pre">x</span></code> that is visible in
<code class="docutils literal notranslate"><span class="pre">foo()</span></code> is the one defined at global scope, so the value 0 is
printed.</p>
<p>A more interesting case of static scope arises in languages that allow
the definition of functions inside other functions. This set of
languages includes the Lisp family, Python, Pascal, and to a limited
extent, newer versions of C++ and Java. Let’s consider a concrete
example in Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="nf">baz</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">baz</span>

<span class="k">def</span> <span class="nf">bar</span><span class="p">():</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">foo</span><span class="p">()()</span>  <span class="c1"># call baz()</span>

<span class="n">bar</span><span class="p">()</span>
</pre></div>
</div>
<p>This program calls the function <code class="docutils literal notranslate"><span class="pre">baz()</span></code> that is defined locally in
the context of <code class="docutils literal notranslate"><span class="pre">foo()</span></code>, while the call itself is located in the
context of <code class="docutils literal notranslate"><span class="pre">bar()</span></code>. The global environment consists of the binding
of <code class="docutils literal notranslate"><span class="pre">x</span></code> to 0 at the top-level, as well as bindings of the names
<code class="docutils literal notranslate"><span class="pre">foo</span></code> and <code class="docutils literal notranslate"><span class="pre">bar</span></code> to their respective functions. There are no
bindings in the local environment of <code class="docutils literal notranslate"><span class="pre">baz()</span></code>. Static scoping
requires that the non-local environment of <code class="docutils literal notranslate"><span class="pre">baz()</span></code> be the
environment in which its definition textually appears, which is the
environment frame introduced by the function <code class="docutils literal notranslate"><span class="pre">foo()</span></code>. This frame
contains a binding of <code class="docutils literal notranslate"><span class="pre">x</span></code> to 2. Following our lookup procedure, the
value 2 is printed out since the non-local binding of <code class="docutils literal notranslate"><span class="pre">x</span></code> is the one
that is visible.</p>
<p><a class="reference internal" href="#figure-static-scope"><span class="std std-numref">Figure 4</span></a> shows a visualization of the
environment, as illustrated by <a class="reference external" href="http://www.pythontutor.com/">Python Tutor</a>.</p>
<figure class="align-center" id="id12">
<span id="figure-static-scope"></span><a class="reference internal image-reference" href="_images/static_scope.svg"><img alt="_images/static_scope.svg" src="_images/static_scope.svg" width="500" /></a>
<figcaption>
<p><span class="caption-number">Figure 4 </span><span class="caption-text">Illustration of environment using static scope.</span><a class="headerlink" href="#id12" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Since function definitions are statements in Python that bind the
given name to a function object, they introduce bindings in the frame
in which the function is defined. Python Tutor visualizes the
non-local parent of a locally defined function by naming the parent
frame and annotating the function with the name of the parent frame,
as in <code class="docutils literal notranslate"><span class="pre">[parent=f2]</span></code>. If this is elided, then the parent frame is the
global frame. Thus, the non-local environment of the call to <code class="docutils literal notranslate"><span class="pre">baz()</span></code>
is the frame for the call to <code class="docutils literal notranslate"><span class="pre">foo()</span></code>, while the parent frame of the
latter is the global frame.</p>
<p>Note that the binding of <code class="docutils literal notranslate"><span class="pre">x</span></code> to 1 introduced by <code class="docutils literal notranslate"><span class="pre">bar()</span></code> does not
appear anywhere in the environment of <code class="docutils literal notranslate"><span class="pre">baz()</span></code>, since the definition
of <code class="docutils literal notranslate"><span class="pre">baz()</span></code> is not textually located inside of <code class="docutils literal notranslate"><span class="pre">bar()</span></code>.</p>
<p>Most modern languages use static scope, since it tends to be more
efficient than dynamic scope, as the lookup process can be facilitated
by the compiler. Static scope also generally makes it easier for
programmers to reason about the code, since they don’t have to trace
through the execution in order to figure out what a name refers to.</p>
</section>
<section id="dynamic-scope">
<h2>Dynamic Scope<a class="headerlink" href="#dynamic-scope" title="Link to this heading"></a></h2>
<p>In <em>dynamic</em> scope, the environment at any point in a program is
dependent on how execution evolves at runtime. The non-local
environment of a function consists of those bindings that are visible
at the time the function is called. This rule is applied recursively,
so that a sequence of function calls results in a sequence of frames
that are part of the non-local environment of the innermost function
call.</p>
<p>As a concrete example, consider the following C-like code:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="n">y</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">bar</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>
<span class="w">  </span><span class="n">foo</span><span class="p">();</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="w">  </span><span class="n">bar</span><span class="p">();</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The global environment includes the bindings of <code class="docutils literal notranslate"><span class="pre">x</span></code> to 0 and <code class="docutils literal notranslate"><span class="pre">y</span></code>
to 1. When execution starts at <code class="docutils literal notranslate"><span class="pre">main()</span></code>, its environment consists of
the global frame and the local frame that it introduces that binds
<code class="docutils literal notranslate"><span class="pre">y</span></code> to 3. In the call to <code class="docutils literal notranslate"><span class="pre">bar()</span></code>, the environment of <code class="docutils literal notranslate"><span class="pre">bar()</span></code>
consists of the global frame, the non-local frame of <code class="docutils literal notranslate"><span class="pre">main()</span></code>, and
the local frame of <code class="docutils literal notranslate"><span class="pre">bar()</span></code>. Finally, in the call to <code class="docutils literal notranslate"><span class="pre">foo()</span></code>, the
environment of <code class="docutils literal notranslate"><span class="pre">foo()</span></code> consists of the global frame, the non-local
frame of <code class="docutils literal notranslate"><span class="pre">main()</span></code>, the non-local frame of <code class="docutils literal notranslate"><span class="pre">bar()</span></code>, and the local
frame of <code class="docutils literal notranslate"><span class="pre">foo()</span></code>. Name lookup starts in the innermost frame and
proceeds outward until it finds a binding for the name. A binding for
<code class="docutils literal notranslate"><span class="pre">x</span></code> is found in the frame of <code class="docutils literal notranslate"><span class="pre">bar()</span></code>, and for <code class="docutils literal notranslate"><span class="pre">y</span></code> in the frame
of <code class="docutils literal notranslate"><span class="pre">main()</span></code>, so that the values 2 and 3 are printed.</p>
<p>Dynamic scope can be simpler to implement than static, since the
frames in an environment correspond exactly to the set of frames that
are active during program execution. However, it can result in
behavior that is less obvious from reading the code, as it requires
tracing out the runtime execution of the code to understand what it
does. As a result, few modern languages use dynamic scope.</p>
<p>Languages that allow functions themselves to be passed as arguments
introduce a further complexity when it comes to dynamic scope in the
form of <a class="reference internal" href="functional.html#binding-policy"><span class="std std-ref">binding policy</span></a>. We will defer
discussion of binding policy until we examine <a class="reference internal" href="functional.html#higher-order-functions"><span class="std std-ref">higher-order
functions</span></a>.</p>
</section>
<section id="point-of-declaration-or-definition">
<h2>Point of Declaration or Definition<a class="headerlink" href="#point-of-declaration-or-definition" title="Link to this heading"></a></h2>
<p>The rules we’ve described thus far do not fully specify name lookup
and visibility in languages that allow names to be introduced in the
middle of a block. In particular, does the scope of a name start at
the beginning of the block in which it is introduced or at the point
of introduction? Consider the following C-like code:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Is this code valid? The initialization of <code class="docutils literal notranslate"><span class="pre">x</span></code> occurs after the
print, so allowing code like this would result in undefined behavior.</p>
<p>The C family of languages avoids this problem by stating that the
scope of a name begins at its <em>point of declaration</em> and ends at the
end of the block in which the declaration appears. Thus, the code
above would be a compile-time error. On the other hand, consider the
following:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">print</span><span class="p">(</span><span class="n">x</span><span class="p">);</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Since the local binding of <code class="docutils literal notranslate"><span class="pre">x</span></code> is not in scope at the print call,
the global binding of <code class="docutils literal notranslate"><span class="pre">x</span></code> is visible and the value 2 is printed.</p>
<p>Python, however, does not follow this rule. If a name is defined
within a function body, then its scope starts at the beginning of the
body. However, it is illegal to reference the name before its
initialization. Thus, the following code is erroneous:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">foo</span><span class="p">()</span>
</pre></div>
</div>
<p>This results in an error like the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ne">UnboundLocalError</span><span class="p">:</span> <span class="n">local</span> <span class="n">variable</span> <span class="s1">&#39;x&#39;</span> <span class="n">referenced</span> <span class="n">before</span> <span class="n">assignment</span>
</pre></div>
</div>
<p>Suppose the intent of the programmer in the code above was to modify
the binding of <code class="docutils literal notranslate"><span class="pre">x</span></code> in the global environment rather than to
introduce a new binding in the local frame. Python enables the
programmer to specify this intent with the <code class="docutils literal notranslate"><span class="pre">global</span></code> statement:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">x</span>  <span class="c1"># specify that x refers to the global binding</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>

<span class="n">foo</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>The code now prints out the value 2, modifies the global <code class="docutils literal notranslate"><span class="pre">x</span></code> to be
bound to 3, and prints out 3. A similar <code class="docutils literal notranslate"><span class="pre">nonlocal</span></code> statement is
available to specify that a name refers to a binding in the non-local
environment.</p>
<p>A final consideration is how to handle scope in the context of
mutually recursive functions or classes. Consider the following code:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">bar</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">foo</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Ignoring the fact that the code does not terminate, the scope rules we
described for the C family do not permit this code, since <code class="docutils literal notranslate"><span class="pre">bar()</span></code>
is not in scope when <code class="docutils literal notranslate"><span class="pre">foo()</span></code> is defined. C and C++ get around this
problem by allowing <em>incomplete</em> declarations:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">int</span><span class="w"> </span><span class="n">bar</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span><span class="w">  </span><span class="c1">// incomplete declaration of bar</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">bar</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">foo</span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Java, on the other hand allows methods and classes to be used before
they are declared, avoiding the need for incomplete declarations.
Similarly, older versions of C allowed functions to be used before
declaration, though this was prone to error due to how such uses were
handled in the compiler and linker.</p>
</section>
<section id="implementation-strategies">
<span id="activation-record-implementation-strategies"></span><h2>Implementation Strategies<a class="headerlink" href="#implementation-strategies" title="Link to this heading"></a></h2>
<p>A binding is an association between a name and an object, making an
associative container such as a dictionary a natural abstraction for
keeping track of bindings. A dictionary-based implementation strategy
can represent each frame with its own dictionary, as well as a pointer
to the next outer frame, if there is one. Adding bindings and looking
up names can be done dynamically by inserting new entries into frames
at runtime or searching through the list of frames for an entry that
matches a given name.</p>
<p>Static languages often take a more efficient approach of translating a
name to an offset in a frame at compile time. This strategy requires
static scope so that names can be resolved to frames by the compiler.
As an example, consider the following code written in a C-like syntax,
but with nested function definitions:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">foo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">3.1</span><span class="p">;</span>

<span class="w">  </span><span class="kt">double</span><span class="w"> </span><span class="n">bar</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>

<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="n">bar</span><span class="p">;</span>
<span class="p">}</span>

<span class="n">foo</span><span class="p">(</span><span class="mi">3</span><span class="p">)(</span><span class="mi">4</span><span class="p">);</span><span class="w">  </span><span class="c1">// evaluates to -2.1</span>
</pre></div>
</div>
<p>A compiler can examine the code in <code class="docutils literal notranslate"><span class="pre">foo()</span></code> to determine how much
space its activation record requires, factoring in parameters, local
variables, temporaries, and control data. It can then associate each
variable with a specific offset in the activation record, as in
<a class="reference internal" href="#figure-offset-frame-layout"><span class="std std-numref">Figure 5</span></a>.</p>
<figure class="align-center" id="id13">
<span id="figure-offset-frame-layout"></span><a class="reference internal image-reference" href="_images/offset_frame_layout.svg"><img alt="_images/offset_frame_layout.svg" src="_images/offset_frame_layout.svg" width="400" /></a>
<figcaption>
<p><span class="caption-number">Figure 5 </span><span class="caption-text">An offset-based layout scheme associates fixed offsets with
individual pieces of data.</span><a class="headerlink" href="#id13" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The value of <code class="docutils literal notranslate"><span class="pre">x</span></code> in the scope of <code class="docutils literal notranslate"><span class="pre">foo()</span></code> is stored at offset zero
from the beginning of the activation record, while the value of <code class="docutils literal notranslate"><span class="pre">y</span></code>
is stored at offset four. In the activation record for <code class="docutils literal notranslate"><span class="pre">bar()</span></code>, its
parameter <code class="docutils literal notranslate"><span class="pre">x</span></code> is stored at offset zero, while a pointer to the
invocation’s next outer frame is stored at offset eight.
(Alternatively, a direct pointer to the memory location for <code class="docutils literal notranslate"><span class="pre">y</span></code> can
be stored, rather than a pointer to the activation record containing
<code class="docutils literal notranslate"><span class="pre">y</span></code>.) <a class="reference internal" href="#figure-offset-frame-data"><span class="std std-numref">Figure 6</span></a> shows the actual activation
records created by the invocations <code class="docutils literal notranslate"><span class="pre">foo(3)(4)</span></code>.</p>
<figure class="align-center" id="id14">
<span id="figure-offset-frame-data"></span><a class="reference internal image-reference" href="_images/offset_frame_data.svg"><img alt="_images/offset_frame_data.svg" src="_images/offset_frame_data.svg" width="400" /></a>
<figcaption>
<p><span class="caption-number">Figure 6 </span><span class="caption-text">Data stored using an offset-based layout.</span><a class="headerlink" href="#id14" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>When the compiler generates code for the body of <code class="docutils literal notranslate"><span class="pre">bar()</span></code>, the
reference to <code class="docutils literal notranslate"><span class="pre">x</span></code> is translated to an offset of zero into the
activation record for <code class="docutils literal notranslate"><span class="pre">bar()</span></code>, while the reference to <code class="docutils literal notranslate"><span class="pre">y</span></code> is
translated into first retrieving the outer frame pointer from offset
eight in the activation record for <code class="docutils literal notranslate"><span class="pre">bar()</span></code>, followed by an offset of
four in the outer frame. Thus, the values 4.0 and 6.1 are retrieved
for <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, respectively, resulting in a difference of -2.1.</p>
<p>The offset-based implementation requires only a single memory access
for a local variable, as opposed to a dictionary lookup in a
dictionary-based implementation. For a local variable in the
<span class="math notranslate nohighlight">\(n\)</span>th other frame, an offset-based strategy requires <span class="math notranslate nohighlight">\(n\)</span>
memory accesses, while a dictionary-based scheme does <span class="math notranslate nohighlight">\(n\)</span>
dictionary lookups. A memory access is likely to be much more
efficient than a dictionary lookup, resulting in better performance
for offset-based implementations.</p>
</section>
</section>
<section id="control-flow">
<h1>Control Flow<a class="headerlink" href="#control-flow" title="Link to this heading"></a></h1>
<p>We now turn our attention to the problem of managing the sequence of
actions that take place in a program. Sequencing is of particular
importance in imperative programming; in this paradigm, each
programming construct specifies some action to be taken, and the flow
of control between constructs is instrumental to the meaning of a
program.</p>
<section id="expression-sequencing">
<h2>Expression Sequencing<a class="headerlink" href="#expression-sequencing" title="Link to this heading"></a></h2>
<p>As we saw in <a class="reference internal" href="#expressions">Expressions</a>, the order in which subexpressions are
evaluated is a consideration in the evaluation of a compound
expression, though a well-defined order is most important in languages
that allow expressions to have side effects. Here, we consider some
cases in which the evaluation semantics are of particular importance.</p>
<section id="short-circuiting">
<h3>Short Circuiting<a class="headerlink" href="#short-circuiting" title="Link to this heading"></a></h3>
<p>Consider a conditional of the following form in C++:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">foo</span><span class="p">(</span><span class="n">x</span><span class="p">))</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="p">...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If the order of evaluation of the operands to the <code class="docutils literal notranslate"><span class="pre">&amp;&amp;</span></code> operator were
left up to the implementation, it would be legal to evaluate the call
to <code class="docutils literal notranslate"><span class="pre">foo()</span></code> on the right-hand side before the comparison with 0 on
the left-hand side. This is problematic in two cases. First, if
<code class="docutils literal notranslate"><span class="pre">foo()</span></code> requires that its argument is non-zero, such as in the case
that it uses the argument as a divisor, then its evaluation can lead
to a runtime error or, even worse, undefined behavior. Second, if
<code class="docutils literal notranslate"><span class="pre">foo()</span></code> performs a very expensive computation, then it would be
unnecessarily computed in the case that <code class="docutils literal notranslate"><span class="pre">x</span></code> is 0.</p>
<p>To address these problems, boolean operators in many languages
evaluate their left-hand operand before the right-hand one and are
also <em>short circuiting</em>. This means that the right-hand side is not
computed if the overall value of the expression can be determined from
the left-hand side alone. This is the case in conjunction (logical
and) if the left-hand side evaluates to a false value, and in
disjunction (logical or) if it evaluates to a true value.</p>
<p>A similar situation occurs with ternary conditional operators, such
as <code class="docutils literal notranslate"><span class="pre">?:</span></code> in the C family:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="n">x</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="o">?</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">);</span>
</pre></div>
</div>
<p>Here, if <code class="docutils literal notranslate"><span class="pre">x</span></code> is 0, the the second operand is not computed, and <code class="docutils literal notranslate"><span class="pre">y</span></code>
is set to 0. On the other hand, if <code class="docutils literal notranslate"><span class="pre">x</span></code> is not 0, then the second
operand is computed but not the third, so <code class="docutils literal notranslate"><span class="pre">y</span></code> is set to the value
obtained by dividing <code class="docutils literal notranslate"><span class="pre">z</span></code> by <code class="docutils literal notranslate"><span class="pre">x</span></code>.</p>
</section>
<section id="explicit-sequences">
<h3>Explicit Sequences<a class="headerlink" href="#explicit-sequences" title="Link to this heading"></a></h3>
<p>Some languages provide an explicit mechanism for chaining expressions
in an ordered sequence. Generally, the result of the expression
sequence as a whole is the result of the last expression in the
sequence. In C and C++, the comma operator sequences expressions in
this manner:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">);</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
</pre></div>
</div>
<p>This prints out the value 4, since the expression <code class="docutils literal notranslate"><span class="pre">3,</span> <span class="pre">4</span></code> evaluates
to 4. Similarly, in the Lisp family, the <code class="docutils literal notranslate"><span class="pre">begin</span></code> form chains
expressions together:</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">begin</span><span class="w"> </span><span class="p">(</span><span class="nb">+</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="nb">/</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</section>
<section id="compound-assignment">
<h3>Compound Assignment<a class="headerlink" href="#compound-assignment" title="Link to this heading"></a></h3>
<p>In the evaluation of compound-assignment operators, the number of
times the left-hand side is evaluated can affect the result in the
presence of side effects. In most languages with compound assignment,
the following two operations are <strong>not</strong> equivalent in general:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The difference is that in the first case, the expression <code class="docutils literal notranslate"><span class="pre">x</span></code> is only
evaluated once, while in the second, it is evaluated twice. As a
concrete example of where the results differ, consider the following
Python code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
    <span class="n">values</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span>

<span class="n">mylist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">foo</span><span class="p">(</span><span class="n">mylist</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This results in <code class="docutils literal notranslate"><span class="pre">mylist</span></code> being equal to <code class="docutils literal notranslate"><span class="pre">[1]</span></code>. On the other hand,
consider the following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mylist</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">foo</span><span class="p">(</span><span class="n">mylist</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">foo</span><span class="p">(</span><span class="n">mylist</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">mylist</span></code> ends up equal to <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">0]</span></code>. Thus, the two operations
are not equivalent.</p>
</section>
</section>
<section id="statement-sequences">
<h2>Statement Sequences<a class="headerlink" href="#statement-sequences" title="Link to this heading"></a></h2>
<p>Statements by their very nature generally have side effects, so their
order of execution is of fundamental importance in imperative
programming. Imperative languages generally specify that statements
execute in the order in which they appear in the program text <a class="footnote-reference brackets" href="#id4" id="id3" role="doc-noteref"><span class="fn-bracket">[</span>1<span class="fn-bracket">]</span></a>.</p>
<aside class="footnote-list brackets">
<aside class="footnote brackets" id="id4" role="note">
<span class="label"><span class="fn-bracket">[</span><a role="doc-backlink" href="#id3">1</a><span class="fn-bracket">]</span></span>
<p>The compiler or interpreter can reorder operations if it can
prove that the reordered execution is semantically equivalent
to the original sequence. In single-threaded programs, this
reordering is generally not observable, but it can have
tangible effects in parallel programs. However, we will not
discuss the details here.</p>
</aside>
</aside>
<p>Sequences of statements are often grouped in the form of <em>blocks</em>,
which can appear in contexts where a single statement is expected.
Some languages, such as Python, restrict where a sequence of
statements can appear, such as the body of a structured control
statement. Python uses the term <em>suite</em> for such a sequence rather
than <em>block</em>.</p>
<p>A language’s syntax specifies how statements are separated in a block
or a sequence. Two common strategies are to use a separator character
between each statement, or to require that all statements be
terminated by a particular character. For example, if a semicolon is
used to separate statements, a sequence of statements could have the
following structure:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S_1</span><span class="p">;</span> <span class="n">S_2</span><span class="p">;</span> <span class="o">...</span> <span class="p">;</span> <span class="n">S_N</span>
</pre></div>
</div>
<p>On the other hand, if a semicolon is used to terminate the statements,
the sequence would have the following form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">S_1</span><span class="p">;</span> <span class="n">S_2</span><span class="p">;</span> <span class="o">...</span> <span class="p">;</span> <span class="n">S_N</span><span class="p">;</span>
</pre></div>
</div>
<p>The key difference is that in the second case, the last statement would
require a terminating semicolon.</p>
</section>
<section id="unstructured-transfer-of-control">
<h2>Unstructured Transfer of Control<a class="headerlink" href="#unstructured-transfer-of-control" title="Link to this heading"></a></h2>
<p>Many languages provide a simple mechanism for transferring control in
the form of a <em>goto</em>. This is generally used in conjunction with a
label that specifies which statement is to be executed next. For
example, the following C code prints integers in sequence starting at
0:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="nl">LOOP</span><span class="p">:</span><span class="w"> </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%d</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="p">);</span>
<span class="n">x</span><span class="o">++</span><span class="p">;</span>
<span class="k">goto</span><span class="w"> </span><span class="n">LOOP</span><span class="p">;</span>
</pre></div>
</div>
<p>The code initializes <code class="docutils literal notranslate"><span class="pre">x</span></code> to 0 and proceeds to print it out. It then
increments <code class="docutils literal notranslate"><span class="pre">x</span></code> and transfers control back to the print statement.</p>
<p>Goto statements are a very low-level mechanism of control, usually
mapping directly to a direct jump instruction in machine code.
However, on their own, simple gotos are insufficient to implement most
algorithms since they do not provide any branching. The example above
is an infinite loop and also suffers from integer overflow, resulting
in the values wrapping around. In some languages, variants of goto
exist that do provide branching capability, such as computed goto
in older versions of FORTRAN. Machine code often provides branching
through the use of indirect jump instructions.</p>
<p>While the various forms of goto are very powerful, they are also open
to abuse, resulting in incomprehensible <em>spaghetti code</em> that makes it
difficult to follow the control flow in a program. Part of the problem
is that this unstructured form of transferring control is not amenable
to conventions for improving readability, such as indentation. In the
example above, all statements occur at the same level, and it is not
visually obvious where the loop is. This is even more of a problem when
the goto is many lines away from the label that it references. And if
a piece of code has many labels and many gotos, drawing out the set of
possible paths through the code can result in a mess, resembling a
plate of spaghetti.</p>
<p>Another problem with goto is how to handle the initialization or
destruction of local variables when control passes into or out of a
block. We will see more details about initialization and destruction
shortly, but languages such as C++ with complicated initialization and
destruction semantics often place restrictions on how goto can be
used.</p>
<p>While goto is very powerful, it is not necessary for any algorithm. As
a result, it is common practice to discourage the use of gotos, and
some languages do not include it in their set of control constructs.</p>
<p>There are a few cases, however, where goto or a restricted version of
it can result in simpler and more readable code. However, an example
must wait until after we discuss structured control constructs.</p>
</section>
<section id="structured-control">
<h2>Structured Control<a class="headerlink" href="#structured-control" title="Link to this heading"></a></h2>
<p>Modern languages provide higher-level control constructs than goto,
allowing code to be structured in a more readable and maintainable
way. The most basic constructs are those for expressing conditional
computation and repetition, two features required for a language to be
<em>Turing complete</em>, meaning that the language is equivalent in
computational power to Turing machines.</p>
<section id="conditionals">
<span id="id5"></span><h3>Conditionals<a class="headerlink" href="#conditionals" title="Link to this heading"></a></h3>
<p>We have already seen the ternary conditional operator provided by some
languages for conditional evaluation of expressions. Imperative
languages provide an analogous construct for conditional execution of
statements in the form of the <em>if</em> statement, which has the general
form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">&lt;</span><span class="n">test</span><span class="o">&gt;</span> <span class="n">then</span> <span class="o">&lt;</span><span class="n">statement1</span><span class="o">&gt;</span> <span class="k">else</span> <span class="o">&lt;</span><span class="n">statement2</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">&lt;test&gt;</span></code> is an expression that has a boolean value; depending
on the language, this expression may be required to be of the boolean
type, or the language may allow conversions of other types to a
boolean value. If the resulting value is true, then <code class="docutils literal notranslate"><span class="pre">&lt;statement1&gt;</span></code>
is executed. Otherwise, <code class="docutils literal notranslate"><span class="pre">&lt;statement2&gt;</span></code> is executed.</p>
<p>Often, languages allow the else branch to be elided:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">&lt;</span><span class="n">test</span><span class="o">&gt;</span> <span class="n">then</span> <span class="o">&lt;</span><span class="n">statement</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>However, this can lead to the <em>dangling else</em> problem. Consider the
following example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">&lt;</span><span class="n">test1</span><span class="o">&gt;</span> <span class="n">then</span> <span class="k">if</span> <span class="o">&lt;</span><span class="n">test2</span><span class="o">&gt;</span> <span class="n">then</span> <span class="o">&lt;</span><span class="n">statement1</span><span class="o">&gt;</span> <span class="k">else</span> <span class="o">&lt;</span><span class="n">statement2</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The grouping of the branches can be interpreted as either of the
following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="o">&lt;</span><span class="n">test1</span><span class="o">&gt;</span> <span class="n">then</span> <span class="p">(</span><span class="k">if</span> <span class="o">&lt;</span><span class="n">test2</span><span class="o">&gt;</span> <span class="n">then</span> <span class="o">&lt;</span><span class="n">statement1</span><span class="o">&gt;</span> <span class="k">else</span> <span class="o">&lt;</span><span class="n">statement2</span><span class="o">&gt;</span><span class="p">)</span>
<span class="k">if</span> <span class="o">&lt;</span><span class="n">test1</span><span class="o">&gt;</span> <span class="n">then</span> <span class="p">(</span><span class="k">if</span> <span class="o">&lt;</span><span class="n">test2</span><span class="o">&gt;</span> <span class="n">then</span> <span class="o">&lt;</span><span class="n">statement1</span><span class="o">&gt;</span><span class="p">)</span> <span class="k">else</span> <span class="o">&lt;</span><span class="n">statement2</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Some languages resolve this ambiguity by specifying that an else
belongs to the closest <code class="docutils literal notranslate"><span class="pre">if</span></code>. Others formulate their syntax to avoid
this problem by explicitly indicating where a branch starts and ends.</p>
<p>Another common language feature is to provide a <em>cascading</em> form of
<code class="docutils literal notranslate"><span class="pre">if</span></code>. The following is an example in C:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">test1</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">statement1</span><span class="o">&gt;</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">test2</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">statement2</span><span class="o">&gt;</span>
<span class="o">...</span>
<span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">testN</span><span class="o">&gt;</span><span class="p">)</span> <span class="o">&lt;</span><span class="n">statementN</span><span class="o">&gt;</span>
<span class="k">else</span> <span class="o">&lt;</span><span class="n">statementN</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>As another example, Python also provides an equivalent form, but with
the keyword <code class="docutils literal notranslate"><span class="pre">elif</span></code> rather than <code class="docutils literal notranslate"><span class="pre">else</span> <span class="pre">if</span></code>.</p>
<p>A cascading <code class="docutils literal notranslate"><span class="pre">if</span></code> acts as a conditional with more than two branches.
Though it can always be rewritten as a sequence of nested <code class="docutils literal notranslate"><span class="pre">if</span></code>
statements, the cascaded form can improve readability by making it
visually clear what the disjoint branches are.</p>
<p>A similar, though often more restricted, form of multiple branching is
provided by the <em>case</em> or <em>switch</em> statement. It has the following
general form:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">switch</span> <span class="o">&lt;</span><span class="n">expression</span><span class="o">&gt;</span><span class="p">:</span>
  <span class="k">case</span> <span class="o">&lt;</span><span class="n">value1</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">statement1</span><span class="o">&gt;</span>
  <span class="k">case</span> <span class="o">&lt;</span><span class="n">value2</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">statement2</span><span class="o">&gt;</span>
  <span class="o">...</span>
  <span class="k">case</span> <span class="o">&lt;</span><span class="n">valueN</span><span class="o">&gt;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">statementN</span><span class="o">&gt;</span>
  <span class="n">default</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">statementN</span><span class="o">+</span><span class="mi">1</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">switch</span></code> expression is evaluated, and then its value is compared
to those specified in the <code class="docutils literal notranslate"><span class="pre">case</span></code> branches. If the value matches one
of the branches, then that branch is executed. If the value does not
match the value in any <code class="docutils literal notranslate"><span class="pre">case</span></code> branch, then the <code class="docutils literal notranslate"><span class="pre">default</span></code> branch is
executed.</p>
<p>There are many variations in both the syntax and the exact semantics
of a <code class="docutils literal notranslate"><span class="pre">switch</span></code> statement. Usually, the values in the <code class="docutils literal notranslate"><span class="pre">case</span></code>
branches must be compile-time constants, restricting the set of types
that the <code class="docutils literal notranslate"><span class="pre">switch</span></code> expression may have. Some languages allow multiple
alternative values to be specified for a single <code class="docutils literal notranslate"><span class="pre">case</span></code>. Depending on
the language, execution of the <code class="docutils literal notranslate"><span class="pre">case</span></code> branches may be disjoint, or
execution from one branch “falls” into the next branch unless an
explicit <code class="docutils literal notranslate"><span class="pre">break</span></code> or <code class="docutils literal notranslate"><span class="pre">goto</span></code> is present. Often, the <code class="docutils literal notranslate"><span class="pre">default</span></code>
branch may be elided. In some languages, such as Swift, eliding the
<code class="docutils literal notranslate"><span class="pre">default</span></code> clause requires the combination of the <code class="docutils literal notranslate"><span class="pre">case</span></code> branches
to cover all possible values that can be provided to the <code class="docutils literal notranslate"><span class="pre">switch</span></code>.</p>
<p>Part of the motivation for providing separate <code class="docutils literal notranslate"><span class="pre">if</span></code> and <code class="docutils literal notranslate"><span class="pre">switch</span></code>
statements is that the latter often can be implemented more
efficiently. More importantly, however, is that the two constructs are
more suitable for different situations. The <code class="docutils literal notranslate"><span class="pre">switch</span></code> statement is
ideal for when execution can follow multiple discrete paths based on
the value of an expression that isn’t necessarily true or false, while
the <code class="docutils literal notranslate"><span class="pre">if</span></code> statement is appropriate if the flow of execution is
determined by a set of boolean conditions.</p>
</section>
<section id="loops">
<h3>Loops<a class="headerlink" href="#loops" title="Link to this heading"></a></h3>
<p>Loops are a common mechanism for repetition in imperative languages.
They allow a programmer to specify that a computation should repeat
either a certain number of times, or until some condition is met.</p>
<p>Some languages provide loop constructs that repeat for a bounded
number of iterations determined at the beginning of the loop. Such a
construct is actually insufficient to express all algorithms, so
languages that only provide bounded iteration, without some other
mechanism such as unbounded loops or gotos, are not Turing complete.</p>
<p>The most general form of unbounded iteration is the <code class="docutils literal notranslate"><span class="pre">while</span></code> loop:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">while</span> <span class="o">&lt;</span><span class="n">expression</span><span class="o">&gt;</span> <span class="n">do</span> <span class="o">&lt;</span><span class="n">statement</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>Such a loop tests the expression to see if it is true, and if so,
executes the statement and repeats the process.</p>
<p>There are many variations on <code class="docutils literal notranslate"><span class="pre">while</span></code> loops. Some languages have a
form similar to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">do</span> <span class="o">&lt;</span><span class="n">statement</span><span class="o">&gt;</span> <span class="n">until</span> <span class="o">&lt;</span><span class="n">expression</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This repeatedly executes a statement until a condition is met. Another
variant is the <code class="docutils literal notranslate"><span class="pre">do</span> <span class="pre">while</span></code> loop:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">do</span> <span class="o">&lt;</span><span class="n">statement</span><span class="o">&gt;</span> <span class="k">while</span> <span class="o">&lt;</span><span class="n">expression</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This is the same as <code class="docutils literal notranslate"><span class="pre">do</span> <span class="pre">until</span></code>, except that the control expression
is negated. In both forms, the statement is executed at least once,
while a standard <code class="docutils literal notranslate"><span class="pre">while</span></code> loop need not execute its body.</p>
<p>While the <code class="docutils literal notranslate"><span class="pre">while</span></code> loop and its variants are general enough to
express any form of repetition, it is common enough to iterate through
a sequence that languages often provide syntactic sugar to facilitate
the expression of such loops. The <code class="docutils literal notranslate"><span class="pre">for</span></code> loop in the C family of
languages is one example:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="o">&lt;</span><span class="n">initialization</span><span class="o">&gt;</span><span class="p">;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">test</span><span class="o">&gt;</span><span class="p">;</span><span class="w"> </span><span class="o">&lt;</span><span class="n">update</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="n">statement</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>This is, ignoring scope and lifetime details, mostly equivalent to:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">initialization</span><span class="o">&gt;</span><span class="p">;</span>
<span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="o">&lt;</span><span class="n">test</span><span class="o">&gt;</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">statement</span><span class="o">&gt;</span>
<span class="w">  </span><span class="o">&lt;</span><span class="n">update</span><span class="o">&gt;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Another, more abstract, type of loop is a <em>foreach</em> loop that iterates
through the elements in a sequence, with the compiler inferring the
initialization, test, and update. Such a loop may also be called a
<em>range-based for loop</em>. The following is an example in C++11:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">template</span><span class="w"> </span><span class="o">&lt;</span><span class="k">typename</span><span class="w"> </span><span class="nc">Container</span><span class="o">&gt;</span>
<span class="kt">void</span><span class="w"> </span><span class="n">print_all</span><span class="p">(</span><span class="k">const</span><span class="w"> </span><span class="n">Container</span><span class="w"> </span><span class="o">&amp;</span><span class="n">values</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="k">auto</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">values</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The function <code class="docutils literal notranslate"><span class="pre">print_all()</span></code> iterates through all the values in any
container that supports the iterator interface and prints out each
value. The Python <code class="docutils literal notranslate"><span class="pre">for</span></code> loop provides a similar abstraction.</p>
</section>
<section id="loop-termination">
<h3>Loop Termination<a class="headerlink" href="#loop-termination" title="Link to this heading"></a></h3>
<p>Normally, a loop terminates when the specified condition no longer
holds, or in the case of foreach loops, when the elements of the
sequence are exhausted. However, certain algorithms can be better
expressed if a loop can be explicitly terminated in the middle of its
execution. An example is the following C++ function that determines if
a particular value is in an array:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span><span class="w"> </span><span class="nf">contains</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">array</span><span class="p">,</span><span class="w"> </span><span class="kt">size_t</span><span class="w"> </span><span class="n">size</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="k">return</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Once a value is found in the array, it is no longer necessary to
examine the remaining elements of the array, so the function returns
immediately rather than waiting for the loop to terminate normally.</p>
<p>For the cases where an early termination is desired without
immediately returning, a <code class="docutils literal notranslate"><span class="pre">goto</span></code> may be used in a language that
provides such a construct. For example:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="nl">end</span><span class="p">:</span><span class="w"> </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;found? &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>However, as it is considered desirable to avoid <code class="docutils literal notranslate"><span class="pre">goto</span></code> wherever
possible, many languages provide a restricted <code class="docutils literal notranslate"><span class="pre">break</span></code> statement that
explicitly exits a loop and proceeds to the next statement:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">bool</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span>
<span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="kt">size_t</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">size</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">array</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">found</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="w">    </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;found? &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">found</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>A related construct is <code class="docutils literal notranslate"><span class="pre">continue</span></code>, which merely ends the current
loop iteration rather than exiting the loop entirely.</p>
<p>The simple <code class="docutils literal notranslate"><span class="pre">break</span></code> and <code class="docutils literal notranslate"><span class="pre">continue</span></code> statements suffice when a single
loop is involved. What if, on the other hand, we have nested loops,
such as the following:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(...)</span><span class="w"> </span><span class="k">break</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Which loop does the <code class="docutils literal notranslate"><span class="pre">break</span></code> statement terminate? As with dangling
else, generally the innermost loop is the one that is terminated. If
we wish to terminate the outer loop, however, we are forced to use a
<code class="docutils literal notranslate"><span class="pre">goto</span></code> in C and C++:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">for</span><span class="w"> </span><span class="p">(...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(...)</span><span class="w"> </span><span class="k">goto</span><span class="w"> </span><span class="n">end</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
<span class="nl">end</span><span class="p">:</span><span class="w"> </span><span class="p">...</span>
</pre></div>
</div>
<p>Java address this problem by allowing loops to be labeled and
providing forms of <code class="docutils literal notranslate"><span class="pre">break</span></code> and <code class="docutils literal notranslate"><span class="pre">continue</span></code> that take a label:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="nl">outer</span><span class="p">:</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">(...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="k">for</span><span class="w"> </span><span class="p">(...)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(...)</span><span class="w"> </span><span class="k">break</span><span class="w"> </span><span class="n">outer</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Some languages, such as Python, do not provide a specific mechanism
for terminating or continuing an outer loop and require code to be
refactored in such a case.</p>
</section>
</section>
<section id="exceptions">
<h2>Exceptions<a class="headerlink" href="#exceptions" title="Link to this heading"></a></h2>
<p>Exceptions provide a mechanism for implementing error handling in a
structured manner. They allow the detection of errors to be separated
from the task of recovering from an error, as it is often the case
that the program location where an error occurs doesn’t have enough
context to recover from it. Instead, an exception enables normal flow
of execution to be stopped and control to be passed to a handler that
can recover from the error.</p>
<p>In general, languages with exceptions provide:</p>
<ol class="arabic simple">
<li><p>A syntactic construct for specifying what region of code a set of
error handlers covers.</p></li>
<li><p>Syntax for defining error handlers for a particular region of
code and specifying the kinds of exceptions they handle.</p></li>
<li><p>A mechanism for <em>throwing</em> or <em>raising</em> an exception.</p></li>
</ol>
<p>Some languages also provide a means for defining new kinds of
exceptions. For example, in Java, an exception must be a subtype of
<code class="docutils literal notranslate"><span class="pre">Throwable</span></code>, in Python, it must be a subtype of <code class="docutils literal notranslate"><span class="pre">BaseException</span></code>,
and in C++, it can be of any type</p>
<p>An exception may be thrown by the runtime while executing a
built-in operation, such as dividing by zero. It may also be raised
directly by the user, with syntax similar to the following:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">throw</span><span class="w"> </span><span class="n">Exception</span><span class="p">();</span>
</pre></div>
</div>
<p>This consists of a keyword such as <code class="docutils literal notranslate"><span class="pre">throw</span></code> or <code class="docutils literal notranslate"><span class="pre">raise</span></code> indicating
that an exception is to be thrown, as well as the exception value to
be thrown. Some languages, such as Python, allow an exception class to
be specified instead of an instance.</p>
<p>The code that throws an exception may be in a different function than
the code that handles it. Exception handlers are <strong>dynamically
scoped</strong>, so that when an exception is raised, the closest set of
active handlers on the dynamic call stack handles the exception. If
that group of handlers does not handle exceptions of the type that was
thrown, then the next set of handlers on the call stack is used. If
the call stack is exhausted without finding an appropriate handler,
execution terminates.</p>
<p>The following is an example in Python:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">average_input</span><span class="p">():</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s1">&#39;Enter some values: &#39;</span><span class="p">)</span>
            <span class="n">mean</span> <span class="o">=</span> <span class="n">average</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">float</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">())))</span>
        <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Bad values, try again!&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">mean</span>

<span class="k">def</span> <span class="nf">average</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">count</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot compute average of no numbers&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">/</span> <span class="n">count</span>

<span class="n">average_input</span><span class="p">()</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">try</span></code> statement indicates the block of code for which it defines
error handlers. If an exception is raised during execution of the
following suite, and that exception is not handled by a <code class="docutils literal notranslate"><span class="pre">try</span></code>
statement further down in the execution stack, then this <code class="docutils literal notranslate"><span class="pre">try</span></code>
statement attempts to handle the exception. The <code class="docutils literal notranslate"><span class="pre">except</span></code> headers and
their associated suites define the actual exception handlers,
indicating what kinds of exceptions they can handle. When an exception
is raised in the <code class="docutils literal notranslate"><span class="pre">try</span></code> suite, the type of the exception is compared
against the <code class="docutils literal notranslate"><span class="pre">except</span></code> clauses in sequence, and the first one that can
handle an exception of that type is executed. Thus, only one handler
is actually run. The <code class="docutils literal notranslate"><span class="pre">else</span></code> clause, if present, only executes if no
exception is raised in the <code class="docutils literal notranslate"><span class="pre">try</span></code> clause.</p>
<p>In this particular example, an exception may be raised by the built-in
<code class="docutils literal notranslate"><span class="pre">float()</span></code> constructor, if the user enters a value that does not
correspond to a <code class="docutils literal notranslate"><span class="pre">float</span></code>. In this case, a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code> is raised,
and the second <code class="docutils literal notranslate"><span class="pre">except</span></code> clause is executed. If the user enters no
values, then <code class="docutils literal notranslate"><span class="pre">average()</span></code> will directly throw a <code class="docutils literal notranslate"><span class="pre">ValueError</span></code>. Since
the <code class="docutils literal notranslate"><span class="pre">try</span></code> statement in <code class="docutils literal notranslate"><span class="pre">average_input()</span></code> is the closest exception
handler on the execution stack, it is checked for an <code class="docutils literal notranslate"><span class="pre">except</span></code> clause
that handles <code class="docutils literal notranslate"><span class="pre">ValueErrors</span></code>, and the second clause runs. Another case
is if the input stream ends, in which case an <code class="docutils literal notranslate"><span class="pre">EOFError</span></code> is raised,
resulting in execution of the first <code class="docutils literal notranslate"><span class="pre">except</span></code> clause. Finally, if the
user enter one or more valid values, then no exception is raised, and
the <code class="docutils literal notranslate"><span class="pre">else</span></code> clause executes, returning the mean.</p>
<p>Python also allows a <code class="docutils literal notranslate"><span class="pre">finally</span></code> clause to be specified, with code
that should be executed whether or not an exception is raised.
Languages differ in whether they provide <code class="docutils literal notranslate"><span class="pre">finally</span></code> or <code class="docutils literal notranslate"><span class="pre">else</span></code>
clauses. For example, Java provides <code class="docutils literal notranslate"><span class="pre">finally</span></code> while C++ has neither.</p>
<p>Exceptions introduce new control paths in a program, and some
algorithms make use of them for things other than error handling. For
example, in Python, iterators raise a <code class="docutils literal notranslate"><span class="pre">StopIteration</span></code> exception when
the sequence of values they contain is exhausted. Built-in mechanisms
like <code class="docutils literal notranslate"><span class="pre">for</span></code> loops use such an exception to determine when the loop
should terminate.</p>
</section>
</section>
<section id="memory-management">
<h1>Memory Management<a class="headerlink" href="#memory-management" title="Link to this heading"></a></h1>
<p>Programs operate on data, which are stored in memory. In general, the
set of data in use in a program can differ over time, and the amount
of storage required by a program cannot be predicted at compile
time. As a result, a language and its implementation must provide
mechanisms for managing the memory use of a program.</p>
<p>As mentioned in <a class="reference internal" href="#entities-objects-and-variables">Entities, Objects, and Variables</a>, a data object has
a lifetime, also called a <em>storage duration</em>, during which it is valid
to use that object. Once an object’s lifetime has ended, its memory
may be reclaimed for use by other objects. Languages differ from those
in which the user is primarily responsible for managing memory to
languages where the compiler (or interpreter) and runtime bear the
sole responsibility of memory management.</p>
<p>In languages that allow a user to manually manage the memory of
objects, many programming errors result from incorrectly managing
memory. These errors include <em>memory leaks</em>, where a programmer
neglects to release memory that is no longer needed, and <em>dangling
references</em>, where an object is still accessible to a program even
though the user has marked the object as dead. Errors relating to
memory management can be particularly difficult to detect and debug,
since the resulting behavior depends on the complex interplay between
the program and the runtime storage manager and can be different in
separate runs of the program.</p>
<p>There are several strategies that reduce the possibility of errors
related to memory management. This usually involves moving the role of
managing memory from the programmer to the language and its
implementation. Specific examples include tying an object’s lifetime
to the scope of a variable that references it, and to provide
automatic memory management of objects that are not directly linked
with variables.</p>
<section id="storage-duration-classes">
<h2>Storage Duration Classes<a class="headerlink" href="#storage-duration-classes" title="Link to this heading"></a></h2>
<p>Many languages make distinctions between the storage duration of
different objects. This can based on the type of the object, where
its corresponding variable is declared, or manually specified by a
programmer. Common storage duration classes (using C++ terminology)
include static, automatic, thread-local, and dynamic.</p>
<section id="static-storage">
<h3>Static Storage<a class="headerlink" href="#static-storage" title="Link to this heading"></a></h3>
<p>Variables declared at global scope can generally be accessed at any
point in a program, so their corresponding objects must have a
lifetime that spans the entire program. These objects are said to have
<em>static</em> storage duration. In addition to global variables, static
class member variables usually also have static storage duration in
object-oriented languages. Some languages, such as C and C++, also
allow a local variable to be declared with static storage duration, in
which case the corresponding object is shared among all calls to the
associated function.</p>
<p>Since the compiler or linker can determine the set of objects with
static storage duration, such objects are often placed in a special
region of memory at program start, and the memory is not reclaimed
during execution. While the <strong>storage</strong> is pre-allocated, some
languages allow the <strong>initialization</strong> of such objects to be deferred
until their first use.</p>
</section>
<section id="automatic-storage">
<h3>Automatic Storage<a class="headerlink" href="#automatic-storage" title="Link to this heading"></a></h3>
<p>Objects associated with local variables often have <em>automatic</em> storage
duration, meaning they are created at the start of the variable’s
scope and destroyed upon final exit from the scope. As we saw in
<a class="reference internal" href="#blocks">Blocks</a>, in many languages, a block is associated with its own
region of scope. Most languages create a new <em>activation record</em> or
<em>frame</em> upon entry to a block to store the local objects declared in
the block. This frame is usually destroyed when execution exits the
block. It is not destroyed, however, when control enters a nested
block or a function call, since control will return back to the block.</p>
<p>Many languages store activation records in a stack structure. When
execution first enters a block, its activation record (or stack frame)
is pushed onto the stack. If control passes to a nested block or
called function, a stack frame corresponding to the new code is pushed
on the stack, and execution passes to that code. When execution
returns to the original block, the new stack frame is popped, and the
activation record for the original block is again at the top of the
stack. When this block completes, its activation record is popped off,
and the local objects contained within are destroyed.</p>
<p>As we will see later, languages that implement full closures for
nested function definitions cannot always discard a frame upon exit
from a block, since a nested function may require access to the
variables declared in that block. These languages do not place frames
that may be needed later in a stack structure. Instead, they manage
frames by detecting when they are no longer in use and reclaiming
them.</p>
</section>
<section id="thread-local-storage">
<h3>Thread-Local Storage<a class="headerlink" href="#thread-local-storage" title="Link to this heading"></a></h3>
<p>Languages that include multithreading often allow variables to be
declared with <em>thread-local</em> storage duration. The lifetime of their
respective objects matches the duration of execution of a thread, so
that a thread-local object is created at the start of a thread and
destroyed at its end.</p>
<p>Since multiple threads execute concurrently, each thread needs its own
stack for automatic objects and its own memory region for thread-local
objects. These structures are created when a thread begins and are
reclaimed when a thread ends.</p>
</section>
<section id="dynamic-storage">
<h3>Dynamic Storage<a class="headerlink" href="#dynamic-storage" title="Link to this heading"></a></h3>
<p>Objects whose lifetimes are not tied to execution of a specific piece
of code have <em>dynamic</em> storage duration. Such objects are usually
created explicitly by the programmer, such as by a call to a
memory-allocation routine like <code class="docutils literal notranslate"><span class="pre">malloc()</span></code> or through an
object-creation mechanism like <code class="docutils literal notranslate"><span class="pre">new</span></code>. While creation of dynamic
objects is usually an explicit operation, languages differ in whether
the programmer controls destruction of dynamic objects or whether the
runtime is responsible for managing their memory.</p>
<p>Languages with low-level memory-management routines such as
<code class="docutils literal notranslate"><span class="pre">malloc()</span></code> generally have a corresponding <code class="docutils literal notranslate"><span class="pre">free()</span></code> call that
releases the memory allocated by a call to <code class="docutils literal notranslate"><span class="pre">malloc()</span></code>. The user
is responsible for calling <code class="docutils literal notranslate"><span class="pre">free()</span></code> on an object when it is no
longer needed.</p>
<p>Some languages with explicit object-creation mechanisms such as
<code class="docutils literal notranslate"><span class="pre">new</span></code> provide an explicit means for object-destruction, such as
<code class="docutils literal notranslate"><span class="pre">delete</span></code> in C++. As with <code class="docutils literal notranslate"><span class="pre">malloc()</span></code> and <code class="docutils literal notranslate"><span class="pre">free()</span></code>, the programmer
is responsible for applying <code class="docutils literal notranslate"><span class="pre">delete</span></code> to an object when it is no
longer in use.</p>
<p>Other languages manage the destruction of objects automatically rather
than relying on the programmer to do so. These languages implement
<em>garbage collection</em>, which detects when objects are no longer in use
and reclaims their memory. We will discuss <a class="reference internal" href="#garbage-collection">garbage collection</a> in
more detail later in this text.</p>
<p>Since the lifetimes of dynamic objects are not tied to a particular
scope and their destruction need not occur in an order corresponding
to their construction, a stack-based management scheme is insufficient
for dynamic objects. Instead, dynamic objects are usually placed in a
memory region called the <em>heap</em>; the language implementation manages
the storage resources in the heap. We will not discuss techniques for
heap management here.</p>
</section>
</section>
<section id="value-and-reference-semantics">
<span id="id6"></span><h2>Value and Reference Semantics<a class="headerlink" href="#value-and-reference-semantics" title="Link to this heading"></a></h2>
<p>Languages differ as to whether the storage for a variable is the same
as the object it refers to, or whether a variable holds an indirect
reference to an object. The first strategy is often called <em>value
semantics</em>, and the second <em>reference semantics</em>.</p>
<p>To illustrate the distinction between value and reference semantics,
we first examine the semantics of variables in C++. In C++, declaring
a local variable creates an object on the stack, and the object has
automatic storage duration. Within the scope of the variable, it
always refers to the same object. Consider the following code:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="c1">//Note: x&#39;s memory address does not change, even when its value does</span>
</pre></div>
</div>
<p>The declaration of <code class="docutils literal notranslate"><span class="pre">x</span></code> creates an association between the name <code class="docutils literal notranslate"><span class="pre">x</span></code>
and a new object whose value is initialized to 3. Thereafter, as long
as <code class="docutils literal notranslate"><span class="pre">x</span></code> remains in scope, it always refers to that same object. The
assignment <code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">4</span></code> copies the value from the right-hand side into
the object named by the left-hand side, but it does not change which
object <code class="docutils literal notranslate"><span class="pre">x</span></code> refers to. This can be seen by noting that the address of
<code class="docutils literal notranslate"><span class="pre">x</span></code> remains the same before and after the assignment. Thus,
the storage for the variable <code class="docutils literal notranslate"><span class="pre">x</span></code> is always the same as the object it
refers to. We therefore say that C++ has value semantics.</p>
<p>C++ also has a category of variables called <em>references</em>, which do not
have the semantics of allocating memory when they are created.
Instead, they share memory with an existing object. Consider the
following:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="o">&amp;</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="c1">//The following two lines will print the same memory address</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="o">&amp;</span><span class="n">y</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span><span class="w"> </span><span class="c1">//This prints 4</span>
</pre></div>
</div>
<p>In this code, the declaration of <code class="docutils literal notranslate"><span class="pre">x</span></code> creates a new object and
initializes it to 3. The declaration of <code class="docutils literal notranslate"><span class="pre">y</span></code> as a reference does not
create a new object. Instead, <code class="docutils literal notranslate"><span class="pre">y</span></code> refers to the same memory as
<code class="docutils literal notranslate"><span class="pre">x</span></code>, as can be seen by examining their respective addresses.
Assigning to <code class="docutils literal notranslate"><span class="pre">y</span></code> changes the value stored in the memory that <code class="docutils literal notranslate"><span class="pre">y</span></code>
refers to, and subsequently examining <code class="docutils literal notranslate"><span class="pre">x</span></code> shows that its value also
changed, since it shares memory with <code class="docutils literal notranslate"><span class="pre">y</span></code>. <a class="reference internal" href="#figure-reference"><span class="std std-numref">Figure 7</span></a>
is an illustration of what this looks like in memory.</p>
<figure class="align-center" id="id15">
<span id="figure-reference"></span><a class="reference internal image-reference" href="_images/reference.svg"><img alt="_images/reference.svg" src="_images/reference.svg" width="200" /></a>
<figcaption>
<p><span class="caption-number">Figure 7 </span><span class="caption-text">A reference in C++ refers to the same memory location as an
existing object.</span><a class="headerlink" href="#id15" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Finally, C++ has <em>pointers</em>, which are objects that store the
address of another object. A pointer indirectly refers to another
object, and dereferencing the pointer obtains the object it is
referring to:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="p">;</span>
<span class="o">*</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>This code creates a pointer that holds the address of <code class="docutils literal notranslate"><span class="pre">x</span></code> and then
dereferences it to change the value of the corresponding object.
<a class="reference internal" href="#figure-pointer"><span class="std std-numref">Figure 8</span></a> illustrates this in memory.</p>
<figure class="align-center" id="id16">
<span id="figure-pointer"></span><a class="reference internal image-reference" href="_images/pointer.svg"><img alt="_images/pointer.svg" src="_images/pointer.svg" width="200" /></a>
<figcaption>
<p><span class="caption-number">Figure 8 </span><span class="caption-text">A pointer refers to an object indirectly by storing the address of
that object.</span><a class="headerlink" href="#id16" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Pointers refer to objects indirectly, so they provide a form of
reference semantics. And since they refer to objects indirectly, it is
possible to change which objects they refer to after creation:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="o">*</span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">x</span><span class="p">;</span>
<span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">y</span><span class="p">;</span>
<span class="o">*</span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">5</span><span class="p">;</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>In this code, the pointer <code class="docutils literal notranslate"><span class="pre">z</span></code> originally holds the address of <code class="docutils literal notranslate"><span class="pre">x</span></code>,
so it indirectly refers to the object associated with <code class="docutils literal notranslate"><span class="pre">x</span></code>. The value
of <code class="docutils literal notranslate"><span class="pre">z</span></code> is then modified to be the address of <code class="docutils literal notranslate"><span class="pre">y</span></code>, so <code class="docutils literal notranslate"><span class="pre">z</span></code> now
indirectly refers to the object associated with <code class="docutils literal notranslate"><span class="pre">y</span></code>. Dereferencing
<code class="docutils literal notranslate"><span class="pre">z</span></code> and modifying the resulting object now changes the value of
<code class="docutils literal notranslate"><span class="pre">y</span></code> instead of that of <code class="docutils literal notranslate"><span class="pre">x</span></code>. This ability to change which object a
pointer refers to is different than the direct association between
names and objects provided by normal C++ variables and references,
which cannot be broken while the name is in scope.</p>
<p>In a language with reference semantics, variables behave in the same
manner as C++ pointers. In most cases, the variable is allocated on
the stack but indirectly refers to a dynamic object located on the
heap. Thus, the variable has storage that is distinct from the object
it is referencing. This indirect reference can be represented by an
address as in C++ pointers or through a similar mechanism, allowing
the association between variables and the objects they reference to be
changed.</p>
<p>As an example of reference semantics, consider the following Python
code:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">4546751752</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">4546751752</span>
</pre></div>
</div>
<p>The variable <code class="docutils literal notranslate"><span class="pre">x</span></code> is bound to a new list, and then <code class="docutils literal notranslate"><span class="pre">x</span></code> is assigned
to <code class="docutils literal notranslate"><span class="pre">y</span></code>. The <code class="docutils literal notranslate"><span class="pre">id()</span></code> function returns a unique identifier for an
object, which is actually the address of the object in some
implementations. Calling <code class="docutils literal notranslate"><span class="pre">id()</span></code> on <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> show that they
refer to the same object. This differs from non-reference variables in
C++, which never refer to the same object while they are in scope.
<a class="reference internal" href="#figure-refsem1"><span class="std std-numref">Figure 9</span></a> is a representation of the Python program in
memory.</p>
<figure class="align-center" id="id17">
<span id="figure-refsem1"></span><a class="reference internal image-reference" href="_images/refsem1.svg"><img alt="_images/refsem1.svg" src="_images/refsem1.svg" width="400" /></a>
<figcaption>
<p><span class="caption-number">Figure 9 </span><span class="caption-text">In reference semantics, variables indirectly refer to objects on
the heap.</span><a class="headerlink" href="#id17" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Now consider the following additional lines of code:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="go">4546749256</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">id</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="go">4546751752</span>
</pre></div>
</div>
<p>Assigning a new list to <code class="docutils literal notranslate"><span class="pre">x</span></code> changes which object <code class="docutils literal notranslate"><span class="pre">x</span></code> is bound to,
but it does not change which object <code class="docutils literal notranslate"><span class="pre">y</span></code> is bound to. This differs
from C++-style references, which cannot change what object they refer
to. Instead, the behavior is analogous to the following pseudocode
with C++-style pointers:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">list</span><span class="w"> </span><span class="o">*</span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">list</span><span class="p">();</span>
<span class="n">list</span><span class="w"> </span><span class="o">*</span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="p">;</span>
<span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">list</span><span class="p">();</span>
<span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;, &quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
</pre></div>
</div>
<p>The result in memory is shown in <a class="reference internal" href="#figure-refsem2"><span class="std std-numref">Figure 10</span></a>.</p>
<figure class="align-center" id="id18">
<span id="figure-refsem2"></span><a class="reference internal image-reference" href="_images/refsem2.svg"><img alt="_images/refsem2.svg" src="_images/refsem2.svg" width="400" /></a>
<figcaption>
<p><span class="caption-number">Figure 10 </span><span class="caption-text">In reference semantics, assigning to a variable changes which
object it refers to rather than the value of the object itself.</span><a class="headerlink" href="#id18" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The examples above illustrate the key difference between value and
reference semantics: In value semantics, assignment to a variable
changes <strong>the value</strong> of the object that the variable refers to. In
reference semantics, however, assignment to a variable changes
<strong>which</strong> object the variable refers to. The latter can be seen in
the following Python example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">lst</span><span class="p">:</span>
<span class="go">        x = 0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lst</span>
<span class="go">[1, 2, 3, 4]</span>
</pre></div>
</div>
<p>The assignment to <code class="docutils literal notranslate"><span class="pre">x</span></code> in the loop changes which object <code class="docutils literal notranslate"><span class="pre">x</span></code> refers
to rather than the value of the object, as illustrated by <a class="reference external" href="http://www.pythontutor.com/">Python
Tutor</a> in <a class="reference internal" href="#table-python-loop-variable"><span class="std std-numref">Table 2</span></a>.</p>
<span id="table-python-loop-variable"></span><table class="docutils align-center" id="id19">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Assignment to a loop variable in Python changes the object
        the variable is pointing to, rather than its value.</span><a class="headerlink" href="#id19" title="Link to this table"></a></caption>
<tbody>
<tr class="row-odd"><td><p><img alt="refsem_tutor1" src="_images/refsem_tutor1.svg" /></p>
</td>
<td><p><img alt="refsem_tutor2" src="_images/refsem_tutor2.svg" /></p>
</td>
</tr>
</tbody>
</table>
<p>The left side of <a class="reference internal" href="#table-python-loop-variable"><span class="std std-numref">Table 2</span></a> shows the
environment at the start of the first iteration, after <code class="docutils literal notranslate"><span class="pre">x</span></code> is bound
to an element of the list but before it is assigned to 0. Executing
the assignment results in the right-hand side, with <code class="docutils literal notranslate"><span class="pre">x</span></code> rebound but
the list element unaffected. Thus, none of the values in the list are
modified.</p>
<p>As can be seen from the previous examples, C++ has value semantics
while Python has reference semantics. Java, on the other hand, has
value semantics for primitive types but reference semantics for
<code class="docutils literal notranslate"><span class="pre">Object</span></code> and its subclasses, which are often called <em>object types</em>
or <em>reference types</em>.</p>
</section>
<section id="raii-and-scope-based-resource-management">
<span id="scope-based-resource-management"></span><h2>RAII and Scope-Based Resource Management<a class="headerlink" href="#raii-and-scope-based-resource-management" title="Link to this heading"></a></h2>
<p>Programs often make use of complex data abstractions whose
implementations allocate memory for their own internal use. An example
is a growable array, such as the <code class="docutils literal notranslate"><span class="pre">vector</span></code> template in C++ or the
<code class="docutils literal notranslate"><span class="pre">list</span></code> type in Python. These data structures use a contiguous piece
of memory to store elements. When a structure runs out of space, it
must allocate a new region of memory, copy (or move) over the
elements, and release the old memory region. This operation is hidden
behind the abstraction barrier of the data structure, and the growable
array’s implementation handles its own memory management.</p>
<p>For languages with garbage collection, an object that internally
allocates memory does not pose any problems in most cases. If the
object is no longer in use, the garbage collector can usually detect
that the memory it allocated is also no longer in use. In languages
without garbage collection, however, other mechanisms must be used in
order to manage internal resources.</p>
<p>A simple solution is for the interface of a data structure to include
a function that must be explicitly called when the structure is no
longer needed, with a name along the lines of <code class="docutils literal notranslate"><span class="pre">close()</span></code>,
<code class="docutils literal notranslate"><span class="pre">release()</span></code>, or <code class="docutils literal notranslate"><span class="pre">destroy()</span></code>. This is called the <em>dispose pattern</em>,
and it is well-suited to languages where it is idiomatic to deallocate
objects by calling a function such as <code class="docutils literal notranslate"><span class="pre">free()</span></code>; since the user must
explicitly call <code class="docutils literal notranslate"><span class="pre">free()</span></code>, calling another function to release the
object’s internal resources does not break the pattern of explicit
memory management. The following is an example of how this pattern
could be provided for a data type in C:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="k">typedef</span><span class="w"> </span><span class="k">struct</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="p">...</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="n">vector</span><span class="p">;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">vector_init</span><span class="p">(</span><span class="n">vector</span><span class="w"> </span><span class="o">*</span><span class="p">);</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">vector_destroy</span><span class="p">(</span><span class="n">vector</span><span class="w"> </span><span class="o">*</span><span class="p">);</span>
</pre></div>
</div>
<p>The user would be responsible for calling <code class="docutils literal notranslate"><span class="pre">vector_init()</span></code> after
<code class="docutils literal notranslate"><span class="pre">malloc()</span></code> and <code class="docutils literal notranslate"><span class="pre">vector_destroy()</span></code> before <code class="docutils literal notranslate"><span class="pre">free()</span></code>:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">vector</span><span class="w"> </span><span class="o">*</span><span class="n">v</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="k">sizeof</span><span class="w"> </span><span class="n">vector</span><span class="p">);</span>
<span class="n">vector_init</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="p">...</span><span class="w"> </span><span class="c1">// use the vector</span>
<span class="n">vector_destroy</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
<span class="n">free</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>
</pre></div>
</div>
<p>In some object-oriented languages, this style of resource management
is directly integrated in the form of destructors. A <em>destructor</em> is a
special method that is responsible for releasing the internal
resources of an object, and the language ensures that an object’s
destructor is called just before the object is reclaimed. Destructors
are the analogue of constructors: a constructor is called when an
object is being initialized, while a destructor is called when an
object is being destroyed.</p>
<p>The semantics of constructors and destructors give rise to a general
pattern known as <em>resource acquisition is initialization</em>, or <em>RAII</em>.
This ties the management of a resource to the lifetime of an object
that acts as the resource manager, so perhaps a better name for this
scheme is <em>lifetime-based resource management</em>. In the growable array
example above, the constructor allocates the initial memory to be used
by the array. If the array grows beyond its current capacity, a larger
memory area is allocated and the previous one released. The destructor
then ensures that the last piece of allocated memory is released.
Since the constructor is always called when the growable array is
created and the destructor when it is destroyed, the management of its
internal memory is not visible to the user.</p>
<p>The RAII pattern can be used to manage resources other than memory.
For example, an <code class="docutils literal notranslate"><span class="pre">fstream</span></code> object in C++ manages a file handle, which
is a limited resource on most operating systems. The <code class="docutils literal notranslate"><span class="pre">fstream</span></code>
constructor allocates a file handle and its destructor releases it,
ensuring that the lifetime of the file handle is tied to that of the
<code class="docutils literal notranslate"><span class="pre">fstream</span></code> object itself. A similar strategy can be used in a
multithreaded program to tie the acquisition and release of a lock to
the lifetime of an object.</p>
<p>When a resource manager is allocated with automatic storage duration,
its lifetime matches the scope of its corresponding local variable.
Thus, RAII is also known as <em>scope-based resource management</em>. However,
RAII can also be used with dynamic objects in languages that are not
garbage collected. We will see shortly why RAII does not work well
with garbage collection.</p>
<p>Since the specific mechanism of RAII is unsuitable for general
resource management in garbage-collected languages, some languages
provide a specific construct for scope-based resource management.
For example, Python has a <code class="docutils literal notranslate"><span class="pre">with</span></code> construct that works with
<em>context managers</em>, which implement <code class="docutils literal notranslate"><span class="pre">__enter__()</span></code> and
<code class="docutils literal notranslate"><span class="pre">__exit__()</span></code> methods:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">&#39;some_file&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="o">&lt;</span><span class="n">suite</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">open()</span></code> function returns a file object, which defines the
<code class="docutils literal notranslate"><span class="pre">__enter__()</span></code> and <code class="docutils literal notranslate"><span class="pre">__exit__()</span></code> methods that acquire and release a
file handle. The <code class="docutils literal notranslate"><span class="pre">with</span></code> construct ensures that <code class="docutils literal notranslate"><span class="pre">__enter__()</span></code> is
called before the suite is executed and <code class="docutils literal notranslate"><span class="pre">__exit__()</span></code> is called
after the suite has executed. Python ensures that this is the case
even if the suite exits early due to an exception or return.</p>
<p>Newer versions of Java provide a variant of <code class="docutils literal notranslate"><span class="pre">try</span></code> that enables
scope-based resource management. Java also has a <code class="docutils literal notranslate"><span class="pre">synchronized</span></code>
construct that specifically manages the acquisition and release of
locks.</p>
</section>
<section id="garbage-collection">
<h2>Garbage Collection<a class="headerlink" href="#garbage-collection" title="Link to this heading"></a></h2>
<p>To avoid the prevalence of memory errors in languages that rely on
programmers to manage memory, some languages provide automatic memory
management in the form of <em>garbage collection</em>. This involves the use
of runtime mechanisms to detect that objects are no longer in use and
reclaim their associated memory. While a full treatment is beyond the
scope of this text, we briefly discuss two major schemes for garbage
collection: reference counting and tracing collection.</p>
<section id="reference-counting">
<h3>Reference Counting<a class="headerlink" href="#reference-counting" title="Link to this heading"></a></h3>
<p><em>Reference counting</em> is a pattern of memory management where each
object has a count of the number of references to the object. This
count is incremented when a new reference to the object is created,
and it is decremented when a reference is destroyed or modified to
refer to a different object. As an example, consider the following
Python code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
    <span class="n">a</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>  <span class="c1"># object A</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">a</span>
    <span class="n">b</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>  <span class="c1"># object B</span>
    <span class="n">a</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">return</span>
</pre></div>
</div>
<p>A reference-counting implementation of Python, such as CPython, keeps
track of the number of references to each object. Upon a call to
<code class="docutils literal notranslate"><span class="pre">foo()</span></code> and the initialization of <code class="docutils literal notranslate"><span class="pre">a</span></code>, the object <code class="docutils literal notranslate"><span class="pre">A</span></code> has a
reference count of 1. The assignment of <code class="docutils literal notranslate"><span class="pre">a</span></code> to <code class="docutils literal notranslate"><span class="pre">b</span></code> causes the
reference count of <code class="docutils literal notranslate"><span class="pre">A</span></code> to be incremented to 2. Assigning the new
object <code class="docutils literal notranslate"><span class="pre">B</span></code> to <code class="docutils literal notranslate"><span class="pre">b</span></code> causes the count of <code class="docutils literal notranslate"><span class="pre">A</span></code> to be decremented and
the count of <code class="docutils literal notranslate"><span class="pre">B</span></code> to be 1. Assigning <code class="docutils literal notranslate"><span class="pre">None</span></code> to <code class="docutils literal notranslate"><span class="pre">a</span></code> reduces the
count of <code class="docutils literal notranslate"><span class="pre">A</span></code> to 0. At this point, the program no longer has any way
to access the object <code class="docutils literal notranslate"><span class="pre">A</span></code>, so it can be reclaimed. Finally, returning
from <code class="docutils literal notranslate"><span class="pre">foo()</span></code> destroys the variable <code class="docutils literal notranslate"><span class="pre">b</span></code>, so the count of <code class="docutils literal notranslate"><span class="pre">B</span></code>
reduces to 0, and <code class="docutils literal notranslate"><span class="pre">B</span></code> can also be reclaimed.</p>
<p>Reference counting makes operations such as assignment and parameter
passing more expensive, degrading overall performance. As a result,
many language implementations use tracing schemes instead. However,
reference counting has the advantage of providing predictable
performance, making it well-suited to environments where the
unpredictable nature of tracing collection can be problematic, such
as real-time systems.</p>
<p>Some languages that are not garbage collected provide a mechanism for
making use of reference counting in the form of <em>smart pointers</em>. In
C++, the <code class="docutils literal notranslate"><span class="pre">shared_ptr</span></code> template is an abstraction of a
reference-counting pointer. When a <code class="docutils literal notranslate"><span class="pre">shared_ptr</span></code> is created, the
referenced object’s count is incremented, and when the <code class="docutils literal notranslate"><span class="pre">shared_ptr</span></code>
is destroyed, the count is decremented. The referenced object is
destroyed when the count reaches 0. More details on <code class="docutils literal notranslate"><span class="pre">shared_ptr</span></code> and
other C++ smart pointers such as <code class="docutils literal notranslate"><span class="pre">unique_ptr</span></code> and <code class="docutils literal notranslate"><span class="pre">weak_ptr</span></code> can
be found in a <a class="reference external" href="http://www.umich.edu/~eecs381/handouts/C++11_smart_ptrs.pdf">handout from EECS 381</a>.</p>
<p>A weakness of reference counting is that it cannot on its own detect
when circular object chains are no longer in use. A simple example is
a doubly linked list with multiple nodes, where each node holds a
reference to its successor and predecessor, as shown in
<a class="reference internal" href="#figure-double-list1"><span class="std std-numref">Figure 11</span></a>.</p>
<figure class="align-center" id="id20">
<span id="figure-double-list1"></span><a class="reference internal image-reference" href="_images/double_list1.svg"><img alt="_images/double_list1.svg" src="_images/double_list1.svg" width="600" /></a>
<figcaption>
<p><span class="caption-number">Figure 11 </span><span class="caption-text">The nodes in a doubly linked list hold circular references to each
other.</span><a class="headerlink" href="#id20" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Even if the first node is no longer accessible from program code after
destruction of the list object on the left, the node still has a
reference count of one since the second node holds a reference to the
first. This prevents a reference-counting algorithm from reclaiming
the nodes.</p>
<p>One solution is to provide <em>weak references</em>, which hold a reference
to an object without incrementing the object’s reference count. In the
case of a doubly linked list, the reverse links can be represented
using weak references so that they do not affect the reference counts
of predecessor nodes.</p>
<figure class="align-center" id="id21">
<span id="figure-double-list2"></span><a class="reference internal image-reference" href="_images/double_list2.svg"><img alt="_images/double_list2.svg" src="_images/double_list2.svg" width="600" /></a>
<figcaption>
<p><span class="caption-number">Figure 12 </span><span class="caption-text">Weak references can be used to refer to the previous node, to avoid
incrementing a node’s reference count.</span><a class="headerlink" href="#id21" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The weak references in <a class="reference internal" href="#figure-double-list2"><span class="std std-numref">Figure 12</span></a> are shown as
dashed lines. Now if the list object is reclaimed, the first node will
no longer have any non-weak references to it, so its reference count
will be zero. Thus, the first node will be reclaimed, which will then
cause the second node’s count to reach zero, allowing it to be
reclaimed in turn, and so on.</p>
<p>Weak references must be used carefully to ensure that cyclic data
structures can be collected. This places a burden on the programmer,
requiring more effort than the tracing schemes below.</p>
</section>
<section id="tracing-collectors">
<h3>Tracing Collectors<a class="headerlink" href="#tracing-collectors" title="Link to this heading"></a></h3>
<p>More common than reference counting is <em>tracing garbage collection</em>,
which periodically traces out the set of objects in use and collects
objects that are not reachable from program code. These collectors
start out with a <em>root set</em> of objects, generally consisting of the
objects on the stack and those in static or thread-local storage. They
then recursively follow the references inside those objects, and the
objects encountered are considered live. Objects that are not
encountered in this process are reclaimed. For example, if the root
set consists of objects <span class="math notranslate nohighlight">\(A\)</span> and <span class="math notranslate nohighlight">\(H\)</span> in the object graph in
<a class="reference internal" href="#figure-root-set"><span class="std std-numref">Figure 13</span></a>, then objects <span class="math notranslate nohighlight">\(A\)</span> through <span class="math notranslate nohighlight">\(K\)</span>
would be alive while objects <span class="math notranslate nohighlight">\(L\)</span> through <span class="math notranslate nohighlight">\(O\)</span> would be
garbage.</p>
<figure class="align-center" id="id22">
<span id="figure-root-set"></span><a class="reference internal image-reference" href="_images/root_set.svg"><img alt="_images/root_set.svg" src="_images/root_set.svg" width="500" /></a>
<figcaption>
<p><span class="caption-number">Figure 13 </span><span class="caption-text">Tracing garbage collectors trace references starting at a root set,
and objects that are not reachable from the root set are reclaimed.</span><a class="headerlink" href="#id22" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>There are many variants of tracing collectors. A common pattern is
<em>mark and sweep</em>, which is split into separate mark and sweep phases.
Objects are first recursively marked starting from the root set, and
when this completes, unmarked objects are collected. Another pattern
is <em>stop and copy</em>, which copies live objects to a separate,
contiguous region of memory as they are encountered. The latter is
slower and requires more free space but results in better locality of
live objects. It also reduces the problem of memory <em>fragmentation</em>,
where there is sufficient total free space to allocate an object, but
each individual free region of space is too small for the object.
However, since objects are moved, it also requires references and
pointers to such objects to be updated, and the runtime must be able
to distinguish references and pointers from other data values.</p>
<p>Tracing collectors often only run when free space is running low, so
many programs do not even trigger garbage collection. Even in programs
that do require collection, the amortized cost of tracing collection
is often lower than that of reference counting. On the other hand, the
collection process itself can take a significant amount of time, and
it can be problematic if a collection is triggered immediately before
an event that the program needs to respond to, such as user input.</p>
</section>
<section id="finalizers">
<h3>Finalizers<a class="headerlink" href="#finalizers" title="Link to this heading"></a></h3>
<p>Garbage-collected languages often allow <em>finalizers</em> to be defined,
which are analogous to destructors in a language such as C++. A
finalizer is called when an object is being collected, allowing it to
release internal resources in the same manner as destructors. However,
finalizers give rise to a number of issues that do not occur in
destructors. First, a finalizer may not be called in a timely manner,
particularly in implementations that use a tracing collector, since
such a collector often only collects objects when memory resources are
running low. This makes finalizers unsuitable for managing resources
that can be exhausted before memory is. Second, a finalizer may leak a
reference to the object being collected, resurrecting it from the
dead. A collector must be able to handle this case, and this also
leads to the question of whether or not a finalizer should be rerun
when the resurrected object is collected again. Another issue with
finalizers is that they do not run in a well-defined order with
respect to each other, preventing them from being used where the
release of resources must be done in a specific order. Finally, many
languages do not guarantee that finalizers will be called,
particularly on program termination, so programmers cannot rely on
them.</p>
<p>For the reasons above and several others, programmers are often
discouraged from using finalizers for resource management. Instead, a
scope-based mechanism such as the ones discussed previously should be
used when available.</p>
</section>
</section>
</section>
<section id="grammars">
<h1>Grammars<a class="headerlink" href="#grammars" title="Link to this heading"></a></h1>
<p>The <em>grammar</em> of a language specifies what sequences of character
constitute valid fragments of the language. Grammar is only concerned
with the structure of fragments, rather than the meaning. As in
<a class="reference internal" href="#levels-of-description">Levels of Description</a>, the lexical structure of a language
determines what the valid tokens are, and the syntax determines what
sequences of tokens are valid. Here, we consider tools for specifying
the lexical structure and syntax of a language.</p>
<section id="regular-expressions">
<h2>Regular Expressions<a class="headerlink" href="#regular-expressions" title="Link to this heading"></a></h2>
<p>The lexical structure of a language is often specified with regular
expressions. A <em>regular expression</em> is a sequence of characters that
defines a pattern against which strings can be matched.</p>
<p>The fundamental components of a regular expression are the following:</p>
<ul class="simple">
<li><p>the empty string, usually denoted by the Greek letter epsilon:
<span class="math notranslate nohighlight">\(\varepsilon\)</span></p></li>
<li><p>individual characters from the alphabet of a language, such as <em>a</em>
or <em>b</em> in the English alphabet</p></li>
<li><p>concatenation, often denoted by listing a sequence of components,
such as <em>ab</em></p></li>
<li><p><em>alternation</em>, representing a choice between two options, often
denoted by a vertical pipe, as in <em>a|b</em></p></li>
<li><p>repetition with the <em>Kleene star</em>, representing zero or more
occurrences of a component, such as in <em>a*</em></p></li>
</ul>
<p>Parentheses can be used to disambiguate application of concatenation,
alternation, and the Kleene star. When parentheses are elided, the
Kleene star has highest priority, followed by concatenation, followed
by alternation.</p>
<p>The following are examples of regular expressions, as well as the
strings they match:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(a|b\)</span> — matches exactly the strings <em>a</em> and <em>b</em></p></li>
<li><p><span class="math notranslate nohighlight">\(a^*b\)</span> — matches the strings containing any number of <em>a</em>‘s
followed by a single <em>b</em>, i.e. <em>b, ab, aab, aaab, …</em></p></li>
<li><p><span class="math notranslate nohighlight">\((a|b)^*\)</span> — matches any string that contains no characters
other than <em>a</em> or <em>b</em>, including the empty string, i.e.
<span class="math notranslate nohighlight">\(\varepsilon\)</span>, <em>a, b, aa, ab, ba, bb, aaa, …</em></p></li>
<li><p><span class="math notranslate nohighlight">\(ab^*(c|\varepsilon)\)</span> — matches strings that contain a single
<em>a</em>, followed by any number of <em>b</em>‘s, followed by an optional <em>c</em>,
i.e. <em>a, ac, ab, abc, abb, abbc, …</em></p></li>
</ul>
<p>Many regular expression systems provide shorthands for common cases.
For example, the question mark <em>?</em> is often used to denote zero or one
occurrence of an element, so that the last example above could be
written as <span class="math notranslate nohighlight">\(ab^*c\)</span><em>?</em>. Similarly, the plus sign <em>+</em> usually
indicates one or more occurrences of an element, so that <span class="math notranslate nohighlight">\(a^+b\)</span>
matches the strings <em>ab, aab, aaab, …</em> Other common extensions
include a mechanism for specifying a range of characters, shorthand
for a set of characters as well the negation of a set of characters,
and escape sequences, such as for whitespace.</p>
<p>As an example, the following regular expression matches an identifier
or keyword in C++:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">a</span><span class="o">-</span><span class="n">zA</span><span class="o">-</span><span class="n">Z_</span><span class="p">][</span><span class="n">a</span><span class="o">-</span><span class="n">zA</span><span class="o">-</span><span class="n">Z_0</span><span class="o">-</span><span class="mi">9</span><span class="p">]</span><span class="o">*</span>
</pre></div>
</div>
<p>In this particular notation, square brackets denote a set of
characters, acting as shorthand for alternation. A dash specifies a
range of characters, so <em>a-z</em> denotes all the ASCII characters between
<em>a</em> and <em>z</em>, inclusive. Thus, the regular expression matches any
string that begins with a letter or underscore and follows that with
any number of letters, underscores, or digits.</p>
<figure class="align-center" id="id23">
<a class="reference internal image-reference" href="_images/regular_expressions.svg"><img alt="_images/regular_expressions.svg" src="_images/regular_expressions.svg" width="720" /></a>
<figcaption>
<p><span class="caption-number">Figure 14 </span><span class="caption-text">Credit: <a class="reference external" href="http://xkcd.com/">xkcd</a></span><a class="headerlink" href="#id23" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>Regular expressions are a very powerful mechanism in searching for and
matching patterns. However, they are too limited to specify many
common syntax rules. For example, there is no way to write a regular
expression to match strings of the form <span class="math notranslate nohighlight">\(a^nb^n\)</span>, strings that
contain any number of <em>a</em>‘s followed by the same number of <em>b</em>‘s,
such as <span class="math notranslate nohighlight">\(\varepsilon\)</span>, <em>ab, aabb, aaabbb, aaaabbbb, …</em> This is
an even simpler set of strings than that corresponding to matching
sets of parentheses, which include strings such as <em>()()</em> and
<em>(()(()))</em>, that are common to many languages.</p>
</section>
<section id="context-free-grammars">
<h2>Context-Free Grammars<a class="headerlink" href="#context-free-grammars" title="Link to this heading"></a></h2>
<p>While the lexical structure of a language is often specified using
regular expressions, the syntactic structure is generally specified
with a <em>context-free grammar (CFG)</em>. A context-free grammar consists
of a set of variables, a set of <em>terminals</em>, and a collection of
<em>production rules</em> that specify how variables can be replaced with
other variables or terminals. The <em>start variable</em> is the variable
that should be used to begin the replacement process. Variables are
replaced until no more variables remain, leaving just a sequence of
terminals.</p>
<p>As a first example, consider the set of strings containing any number
of <em>a</em>‘s followed by the same number of <em>b</em>‘s. We can specify a
CFG that matches this set of strings. The terminals consist of the
empty string <span class="math notranslate nohighlight">\(\varepsilon\)</span>, <em>a</em>, and <em>b</em>. We need a single
variable, which we will call <em>S</em>, that will also be the start
variable. Then the replacement rules are:</p>
<div class="math notranslate nohighlight">
\[\begin{split}(1)\ S &amp;\rightarrow \varepsilon\\
(2)\ S &amp;\rightarrow a\ S\ b\end{split}\]</div>
<p>To match a particular string, such as <em>aabb</em>, we begin with the start
variable <em>S</em> and recursively apply production rules until we are left
with just terminals that match the string. The following series of
applications leads to the target string:</p>
<div class="math notranslate nohighlight">
\begin{equation*}
\begin{aligned}
S &amp;\rightarrow a\ S\ b \ &amp;\textrm{by application of rule (2)}\\
  &amp;\rightarrow a\ a\ S\ b\ b \ &amp;\textrm{by application of rule (2)}\\
  &amp;\rightarrow a\ a\ b\ b \ &amp;\textrm{by application of rule (1)}
\end{aligned}
\end{equation*}</div><p>The sequence of applications above is called a <em>derivation</em>, and it
demonstrates that the string <em>aabb</em> is matched by the CFG above.</p>
<p>As another example, the following CFG defines the set of strings
consisting of matching parentheses, where <em>P</em> is the start variable:</p>
<div class="math notranslate nohighlight">
\[\begin{split}(1)\ P &amp;\rightarrow \varepsilon\\
(2)\ P &amp;\rightarrow (\ P\ )\\
(3)\ P &amp;\rightarrow P\ P\end{split}\]</div>
<p>We can derive the string <em>(())</em> as follows:</p>
<div class="math notranslate nohighlight">
\begin{equation*}
\begin{aligned}
P &amp;\rightarrow (\ P\ ) \ &amp;\textrm{by application of rule (2)}\\
  &amp;\rightarrow (\ (\ P\ )\ ) \ &amp;\textrm{by application of rule (2)}\\
  &amp;\rightarrow (\ (\ )\ ) \ &amp;\textrm{by application of rule (1)}
\end{aligned}
\end{equation*}</div><p>We can derive the string <em>()()</em> as follows:</p>
<div class="math notranslate nohighlight">
\begin{equation*}
\begin{aligned}
P &amp;\rightarrow P\ P \ &amp;\textrm{by application of rule (3)}\\
  &amp;\rightarrow (\ P\ )\ P \ &amp;\textrm{by application of rule (2)}\\
  &amp;\rightarrow (\ )\ P \ &amp;\textrm{by application of rule (1)}\\
  &amp;\rightarrow (\ )\ (\ P\ ) \ &amp;\textrm{by application of rule (2)}\\
  &amp;\rightarrow (\ )\ (\ ) \ &amp;\textrm{by application of rule (1)}
\end{aligned}
\end{equation*}</div><p>An alternate derivation is as follows:</p>
<div class="math notranslate nohighlight">
\begin{equation*}
\begin{aligned}
P &amp;\rightarrow P\ P \ &amp;\textrm{by application of rule (3)}\\
  &amp;\rightarrow P\ (\ P\ ) \ &amp;\textrm{by application of rule (2)}\\
  &amp;\rightarrow P\ (\ ) \ &amp;\textrm{by application of rule (1)}\\
  &amp;\rightarrow (\ P\ )\ (\ ) \ &amp;\textrm{by application of rule (2)}\\
  &amp;\rightarrow (\ )\ (\ ) \ &amp;\textrm{by application of rule (1)}
\end{aligned}
\end{equation*}</div><p>Other derivations exist as well. However, the derivations have the
same fundamental structure, which we can see by drawing a <em>derivation
tree</em> that represents the recursive application of rules in a tree
structure. The first derivation above has the structure in
<a class="reference internal" href="#figure-derivation-tree1"><span class="std std-numref">Figure 15</span></a>.</p>
<figure class="align-center" id="id24">
<span id="figure-derivation-tree1"></span><a class="reference internal image-reference" href="_images/derivation_tree1.svg"><img alt="_images/derivation_tree1.svg" src="_images/derivation_tree1.svg" width="800" /></a>
<figcaption>
<p><span class="caption-number">Figure 15 </span><span class="caption-text">A derivation of <em>()()</em> that derives the left set of parentheses
first.</span><a class="headerlink" href="#id24" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The second derivation constructs the same structure in a different
order, as shown in <a class="reference internal" href="#figure-derivation-tree2"><span class="std std-numref">Figure 16</span></a>.</p>
<figure class="align-center" id="id25">
<span id="figure-derivation-tree2"></span><a class="reference internal image-reference" href="_images/derivation_tree2.svg"><img alt="_images/derivation_tree2.svg" src="_images/derivation_tree2.svg" width="800" /></a>
<figcaption>
<p><span class="caption-number">Figure 16 </span><span class="caption-text">A derivation of <em>()()</em> that derives the right set of parentheses
first.</span><a class="headerlink" href="#id25" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>The leaves of a derivation tree are terminals, and the in-order
traversal is the string that is matched. In both derivations above,
both the in-order traversal as well as the structure of the tree are
the same.</p>
<p>Let us consider another grammar, representing arithmetic operations
over symbols <em>a</em> and <em>b</em>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}(1)&amp;\ E \rightarrow E\ +\ E\\
(2)&amp;\ E \rightarrow E\ *\ E\\
(3)&amp;\ E \rightarrow a\\
(4)&amp;\ E \rightarrow b\end{split}\]</div>
<p>This CFG has the terminals <em>+</em>, <em>*</em>, <em>a</em>, and <em>b</em>, and the variable
<em>E</em>, which is also the start variable. Consider the string <em>a + b *
a</em>. We can derive it as follows:</p>
<div class="math notranslate nohighlight">
\begin{equation*}
\begin{aligned}
E &amp;\rightarrow E\ +\ E\ \ &amp;\textrm{by application of rule (1)}\\
  &amp;\rightarrow E\ +\ E\ *\ E\ &amp;\textrm{by application of rule (2) on the second}\ E\\
  &amp;\rightarrow a\ +\ E\ *\ E\ &amp;\textrm{by application of rule (3)}\\
  &amp;\rightarrow a\ +\ b\ *\ E\ &amp;\textrm{by application of rule (4)}\\
  &amp;\rightarrow a\ +\ b\ *\ a\ &amp;\textrm{by application of rule (3)}
\end{aligned}
\end{equation*}</div><p>Alternatively, we can derive the string as follows:</p>
<div class="math notranslate nohighlight">
\begin{equation*}
\begin{aligned}
E &amp;\rightarrow E\ *\ E\ \ &amp;\textrm{by application of rule (2)}\\
  &amp;\rightarrow E\ +\ E\ *\ E\ &amp;\textrm{by application of rule (1) on the first}\ E\\
  &amp;\rightarrow a\ +\ E\ *\ E\ &amp;\textrm{by application of rule (3)}\\
  &amp;\rightarrow a\ +\ b\ *\ E\ &amp;\textrm{by application of rule (4)}\\
  &amp;\rightarrow a\ +\ b\ *\ a\ &amp;\textrm{by application of rule (3)}
\end{aligned}
\end{equation*}</div><p>The derivation trees corresponding to the two derivations are in
<a class="reference internal" href="#figure-ambiguous-trees"><span class="std std-numref">Figure 17</span></a>, with the left tree as the result of
the first derivation and the right tree the second.</p>
<figure class="align-center" id="id26">
<span id="figure-ambiguous-trees"></span><a class="reference internal image-reference" href="_images/ambiguous_trees.svg"><img alt="_images/ambiguous_trees.svg" src="_images/ambiguous_trees.svg" width="720" /></a>
<figcaption>
<p><span class="caption-number">Figure 17 </span><span class="caption-text">The string <em>a + b * a</em> can be derived with two different resulting
structures, so the grammar is ambiguous.</span><a class="headerlink" href="#id26" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>While both derivation trees have the same in-order traversal, they
have a fundamentally different structure. In fact, the first tree
corresponds to the <em>*</em> operator having higher precedence than <em>+</em>,
while the second tree is the reverse. Since the CFG admits both
derivations, it is <em>ambiguous</em>.</p>
<p>We can rewrite the CFG to unambiguously give <em>*</em> the higher
precedence, but doing so is cumbersome, particularly when a language
has many operators. Instead, languages often resolve ambiguities by
specifying precedence rules that determine which production rule to
apply when there is a choice of rules that can lead to ambiguity.</p>
</section>
<section id="grammars-in-programming-languages">
<h2>Grammars in Programming Languages<a class="headerlink" href="#grammars-in-programming-languages" title="Link to this heading"></a></h2>
<p>The syntax of a programming language is usually specified using a
context-free grammar. In some languages, the lexical structure is also
specified with a CFG, as every regular expression can be written as a
CFG. In languages that specify the lexical structure with regular
expressions, the terminals of their grammars consist of program tokens.
On the other hand, in those that specify the lexical structure with a
CFG, the terminals are individual characters.</p>
<p>A language’s context-free grammar is often written in <em>extended
Backus-Naur form</em>, which adds convenient shorthands to the basic form
discussed above. In particular, many grammars use notation from
regular expressions, such as alternation and Kleene stars, and the
right arrow specifying a production rule is often replaced with an
ASCII character such as <em>=</em> or <em>:</em>.</p>
<p>As an example, the following is a grammar specifying keywords, boolean
literals, and identifiers in a C-like language, with identifiers
taking the form of the regular expression <code class="docutils literal notranslate"><span class="pre">[a-zA-z_][a-zA-Z_0-9]*</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Identifier</span><span class="p">:</span> <span class="k">except</span> <span class="n">Keyword</span> <span class="ow">and</span> <span class="n">BooleanLiteral</span>
    <span class="n">IdentifierStartCharacter</span>
    <span class="n">IdentifierStartCharacter</span> <span class="n">IdentifierCharacters</span>

<span class="n">IdentifierStartCharacter</span><span class="p">:</span>
    <span class="n">_</span>
    <span class="n">LowerCaseLetter</span>
    <span class="n">UpperCaseLetter</span>

<span class="n">IdentifierCharacters</span><span class="p">:</span>
    <span class="n">IdentifierCharacter</span>
    <span class="n">IdentifierCharacters</span> <span class="n">IdentifierCharacter</span>

<span class="n">IdentifierCharacter</span><span class="p">:</span>
    <span class="n">IdentifierStartCharacter</span>
    <span class="n">Digit</span>

<span class="n">LowerCaseLetter</span><span class="p">:</span> <span class="n">one</span> <span class="n">of</span>
    <span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span> <span class="n">e</span> <span class="n">f</span> <span class="n">g</span> <span class="n">h</span> <span class="n">i</span> <span class="n">j</span> <span class="n">k</span> <span class="n">l</span> <span class="n">m</span> <span class="n">n</span> <span class="n">o</span> <span class="n">p</span> <span class="n">q</span> <span class="n">r</span> <span class="n">s</span> <span class="n">t</span> <span class="n">u</span> <span class="n">v</span> <span class="n">w</span> <span class="n">x</span> <span class="n">y</span> <span class="n">z</span>

<span class="n">UpperCaseLetter</span><span class="p">:</span> <span class="n">one</span> <span class="n">of</span>
    <span class="n">A</span> <span class="n">B</span> <span class="n">C</span> <span class="n">D</span> <span class="n">E</span> <span class="n">F</span> <span class="n">G</span> <span class="n">H</span> <span class="n">I</span> <span class="n">J</span> <span class="n">K</span> <span class="n">L</span> <span class="n">M</span> <span class="n">N</span> <span class="n">O</span> <span class="n">P</span> <span class="n">Q</span> <span class="n">R</span> <span class="n">S</span> <span class="n">T</span> <span class="n">U</span> <span class="n">V</span> <span class="n">W</span> <span class="n">X</span> <span class="n">Y</span> <span class="n">Z</span>

<span class="n">Digit</span><span class="p">:</span> <span class="n">one</span> <span class="n">of</span>
    <span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span> <span class="mi">7</span> <span class="mi">8</span> <span class="mi">9</span>

<span class="n">Keyword</span><span class="p">:</span> <span class="n">one</span> <span class="n">of</span>
    <span class="k">if</span> <span class="k">else</span> <span class="k">while</span> <span class="n">struct</span> <span class="k">break</span> <span class="k">continue</span> <span class="k">return</span>

<span class="n">BooleanLiteral</span><span class="p">:</span> <span class="n">one</span> <span class="n">of</span>
    <span class="n">true</span> <span class="n">false</span>
</pre></div>
</div>
<p>The grammar here follows the convention used in the Java language
specification. In particular, it uses a colon rather than a right
arrow to specify a production rule, and alternation is specified by
placing the different choices on different lines. Finally, it includes
shorthand such as “except” and “one of” to simplify the structure of
the grammar.</p>
<p>Here is the Java specification for a C-style comment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">TraditionalComment</span><span class="p">:</span>
    <span class="o">/</span> <span class="o">*</span> <span class="n">CommentTail</span>

<span class="n">CommentTail</span><span class="p">:</span>
    <span class="o">*</span> <span class="n">CommentTailStar</span>
    <span class="n">NotStar</span> <span class="n">CommentTail</span>

<span class="n">CommentTailStar</span><span class="p">:</span>
    <span class="o">/</span>
    <span class="o">*</span> <span class="n">CommentTailStar</span>
    <span class="n">NotStarNotSlash</span> <span class="n">CommentTail</span>

<span class="n">NotStar</span><span class="p">:</span>
    <span class="n">InputCharacter</span> <span class="n">but</span> <span class="ow">not</span> <span class="o">*</span>
    <span class="n">LineTerminator</span>

<span class="n">NotStarNotSlash</span><span class="p">:</span>
    <span class="n">InputCharacter</span> <span class="n">but</span> <span class="ow">not</span> <span class="o">*</span> <span class="ow">or</span> <span class="o">/</span>
    <span class="n">LineTerminator</span>
</pre></div>
</div>
<p>This grammar takes care to ensure that a <em>*/</em> sequence terminates a
comment, even if it immediately follows other stars, but that a single
star or slash does not do so.</p>
<p>The following is a subset of the Scheme grammar specifying the form of
a list:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;\langle \textrm{list} \rangle\ \rightarrow
  \ (\langle\textrm{datum}\rangle^*)\ |
  \ (\langle\textrm{datum}\rangle^+\ .\ \langle\textrm{datum}\rangle)
  \ |\ \langle\textrm{abbreviation}\rangle\\
&amp;\langle\textrm{abbreviation}\rangle\ \rightarrow
  \ \langle\textrm{abbrev prefix}\rangle\ \langle\textrm{datum}\rangle\\
&amp;\langle\textrm{abbrev prefix}\rangle\ \rightarrow
  \ \textrm{'}\ |\ \textrm{`}\ |\ \textrm{,}\ |\ \textrm{,&#64;}\end{split}\]</div>
<p>Here, the grammar uses the pipe <em>|</em> to denote alternation. Thus, a
list can take the form of zero or more items enclosed by parentheses,
as in the following examples:</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">()</span>
<span class="p">(</span><span class="nb">+</span><span class="p">)</span>
<span class="p">(</span><span class="k">define</span><span class="w"> </span><span class="nv">x</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p>A list can also be a <em>dotted list</em>, with one or more items followed by
a period followed by another item, all enclosed by parentheses. This
produces a list that is terminated by the last item rather than by an
empty list. Here are some examples:</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span>
<span class="p">(</span><span class="nf">a</span><span class="w"> </span><span class="nv">b</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="nv">c</span><span class="p">)</span>
<span class="p">(</span><span class="nf">a</span><span class="w"> </span><span class="o">.</span><span class="w"> </span><span class="p">(</span><span class="nb">list</span><span class="p">))</span>
</pre></div>
</div>
<p>Finally, a list can take the form of a quotation marker followed by an
item:</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="ss">&#39;hello</span>
<span class="o">`</span><span class="nv">world</span>
<span class="o">,</span><span class="nv">foo</span>
<span class="o">,@</span><span class="nv">bar</span>
</pre></div>
</div>
<p>These combinations are syntactic sugar for lists representing
quotation forms:</p>
<div class="highlight-scheme notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="k">quote</span><span class="w"> </span><span class="nv">hello</span><span class="p">)</span>
<span class="p">(</span><span class="k">quasiquote</span><span class="w"> </span><span class="nv">world</span><span class="p">)</span>
<span class="p">(</span><span class="k">unquote</span><span class="w"> </span><span class="nv">foo</span><span class="p">)</span>
<span class="p">(</span><span class="k">unquote-splicing</span><span class="w"> </span><span class="nv">bar</span><span class="p">)</span>
</pre></div>
</div>
<section id="vexing-parse">
<h3>Vexing Parse<a class="headerlink" href="#vexing-parse" title="Link to this heading"></a></h3>
<p>In a particularly complex language such as C++, ambiguity cannot be
avoided in the grammar itself. Instead, external rules have to be
specified for resolving ambiguity. These rules can be based on context
that is impossible to capture in a context-free grammar. For example,
in C++, whether or not a name refers to a type is used in
disambiguation, and C++ prefers to disambiguate in favor of a
declaration wherever possible. Coupled with the fact that C++ allows
names to be parenthesized even in declarations, this leads to a class
of vexing parses.</p>
<p>Consider the following example:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">foo</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">foo</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;foo::foo()&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="n">foo</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;foo::foo(&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="k">operator</span><span class="o">=</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;foo::operator=(&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;)&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>

<span class="kt">int</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">4</span><span class="p">;</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">foo</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
<span class="w">  </span><span class="n">foo</span><span class="p">(</span><span class="n">b</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The two lines in <code class="docutils literal notranslate"><span class="pre">main()</span></code> are interpreted as declarations, not as a
call to the constructor in the first line or a call to the constructor
followed by the assignment operator in the second. Instead, the code
is equivalent to:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">foo</span><span class="w"> </span><span class="n">a</span><span class="p">;</span>
<span class="w">  </span><span class="n">foo</span><span class="w"> </span><span class="n">b</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A perhaps more vexing case results from the fact that C++ allows
parameter names to be elided in a function declaration, and the elided
name can be parenthesized. The following is an example of a function
declaration with an elided parameter name:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="kt">int</span><span class="p">);</span>
</pre></div>
</div>
<p>Parenthesizing the elided name results in:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="kt">void</span><span class="w"> </span><span class="nf">func</span><span class="p">(</span><span class="kt">int</span><span class="p">());</span>
</pre></div>
</div>
<p>Now consider the following class:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="k">struct</span><span class="w"> </span><span class="nc">bar</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="n">bar</span><span class="p">(</span><span class="n">foo</span><span class="w"> </span><span class="n">f</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">cout</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="s">&quot;bar::bar(foo)&quot;</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="n">endl</span><span class="p">;</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">};</span>
</pre></div>
</div>
<p>Then the following line is ambiguous:</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="n">bar</span><span class="w"> </span><span class="nf">c</span><span class="p">(</span><span class="n">foo</span><span class="p">());</span>
</pre></div>
</div>
<p>This can be the declaration of an object <code class="docutils literal notranslate"><span class="pre">c</span></code> of type <code class="docutils literal notranslate"><span class="pre">bar</span></code>, with a
newly created <code class="docutils literal notranslate"><span class="pre">foo</span></code> object passed to the constructor. On the other
hand, it can be the declaration of a function <code class="docutils literal notranslate"><span class="pre">c</span></code>, with return type
<code class="docutils literal notranslate"><span class="pre">bar</span></code>, that takes in an unnamed parameter of type <code class="docutils literal notranslate"><span class="pre">foo</span></code>. In this
case, the elided name is parenthesized. The C++ standard requires such
a situation to be disambiguated in favor of a function declaration,
resulting in the latter.</p>
<p>The disambiguation above is often referred to as the <em>most vexing
parse</em>, and many compilers produce a warning when they encounter it.
For example, Clang reports the following message on the code above:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">foo</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">8</span><span class="p">:</span> <span class="n">warning</span><span class="p">:</span> <span class="n">parentheses</span> <span class="n">were</span> <span class="n">disambiguated</span> <span class="k">as</span> <span class="n">a</span> <span class="n">function</span>
<span class="n">declaration</span>
      <span class="p">[</span><span class="o">-</span><span class="n">Wvexing</span><span class="o">-</span><span class="n">parse</span><span class="p">]</span>
  <span class="n">bar</span> <span class="n">c</span><span class="p">(</span><span class="n">foo</span><span class="p">());</span>
     <span class="o">^~~~~~~</span>
<span class="n">foo</span><span class="o">.</span><span class="n">cpp</span><span class="p">:</span><span class="mi">29</span><span class="p">:</span><span class="mi">9</span><span class="p">:</span> <span class="n">note</span><span class="p">:</span> <span class="n">add</span> <span class="n">a</span> <span class="n">pair</span> <span class="n">of</span> <span class="n">parentheses</span> <span class="n">to</span> <span class="n">declare</span> <span class="n">a</span> <span class="n">variable</span>
  <span class="n">bar</span> <span class="n">c</span><span class="p">(</span><span class="n">foo</span><span class="p">());</span>
        <span class="o">^</span>
        <span class="p">(</span>    <span class="p">)</span>
</pre></div>
</div>
<p>The extra pair of parentheses force the compiler to treat <code class="docutils literal notranslate"><span class="pre">foo()</span></code> as
an expression, resulting in an object declaration rather than a
function declaration.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index-2.html" class="btn btn-neutral float-left" title="Programming Language Principles and Paradigms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="functional.html" class="btn btn-neutral float-right" title="Introduction to Scheme" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2016, Amir Kamil, licensed under the Creative Commons Attribution-ShareAlike 4.0 International license.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org/">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>

<!-- Mirrored from eecs390.github.io/notes/foundations.html by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 19 Mar 2024 18:15:41 GMT -->
</html>